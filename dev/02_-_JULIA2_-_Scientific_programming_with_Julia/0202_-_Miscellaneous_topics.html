<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>0202 - Miscellaneous topics · SPMLJ</title><meta name="title" content="0202 - Miscellaneous topics · SPMLJ"/><meta property="og:title" content="0202 - Miscellaneous topics · SPMLJ"/><meta property="twitter:title" content="0202 - Miscellaneous topics · SPMLJ"/><meta name="description" content="Documentation for SPMLJ."/><meta property="og:description" content="Documentation for SPMLJ."/><meta property="twitter:description" content="Documentation for SPMLJ."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-Q39LHCRBB6"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Q39LHCRBB6', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">SPMLJ</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Index</a></li><li><span class="tocitem">Lessons</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">INTRO - Introduction to the course, Julia and ML</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0001_-_Course_presentation.html">0001 - Course presentation</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0002_-_Program.html">0002 - Program</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0003_-_Introduction_to_Julia.html">0003 - Introduction to Julia</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0003q_-_QUIZ_0.1.html">0003q - QUIZ 0.1</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004_-_Introduction_to_ML.html">0004 - Introduction to ML</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004q_-_QUIZ_0.2.html">0004q - QUIZ 0.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">JULIA1 - Basic Julia programming</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101_-_Basic_syntax.html">0101 - Basic syntax</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101q_-_QUIZ_1.1.html">0101q - QUIZ 1.1</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101q_-_QUIZ_1.2.html">0101q - QUIZ 1.2</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0102_-_Types_and_objects.html">0102 - Types and objects</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0102q_-_QUIZ_1.3.html">0102q - QUIZ 1.3</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103_-_Predefined_types.html">0103 - Predefined types</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.4.html">0103q - QUIZ 1.4</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.5.html">0103q - QUIZ 1.5</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.6.html">0103q - QUIZ 1.6</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104_-_Control_flow_and_functions.html">0104 - Control flow and functions</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104q_-_QUIZ_1.7.html">0104q - QUIZ 1.7</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104q_-_QUIZ_1.8.html">0104q - QUIZ 1.8</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105_-_Custom_types.html">0105 - Custom types</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105q_-_QUIZ_1.10.html">0105q - QUIZ 1.10</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105q_-_QUIZ_1.9.html">0105q - QUIZ 1.9</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.html">0105x EXERCISE-1.1</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106_-_Further_topics.html">0106 - Further topics</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.11.html">0106q - QUIZ 1.11</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.12.html">0106q - QUIZ 1.12</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.13.html">0106q - QUIZ 1.13</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">JULIA2 - Scientific programming with Julia</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="0201_-_Wranging_data.html">0201 - Wranging data</a></li><li class="is-active"><a class="tocitem" href="0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics</a><ul class="internal"><li><a class="tocitem" href="#Some-stuff-to-set-up-the-environment.."><span>Some stuff to set-up the environment..</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li><li><a class="tocitem" href="#Probabilistic-analysis"><span>Probabilistic analysis</span></a></li><li><a class="tocitem" href="#Curve-fitting"><span>Curve fitting</span></a></li><li><a class="tocitem" href="#Constrained-optimisation"><span>Constrained optimisation</span></a></li></ul></li><li><a class="tocitem" href="0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1</a></li><li><a class="tocitem" href="0202x_EXERCISE-2.2.html">0202x EXERCISE-2.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">ML1 - Introduction to Machine Learning</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0301_-_Machine_learning_main_concepts.html">0301 - Machine learning main concepts</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302_-_The_Perceptron_classifier.html">0302 - The Perceptron classifier</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302x_EXERCISE-3.1.html">0302x EXERCISE-3.1</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">NN - Neural Networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0401_-_Neural_network_architectures.html">0401 - Neural network architectures</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402_-_Implementation_of_neural_networks_workflows.html">0402 - Implementation of neural networks workflows</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.1.html">0402x EXERCISE-4.1</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.2.html">0402x EXERCISE-4.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">DT - Decision trees based algorithms [DRAFT]</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0501_-_Decision_trees_based_algorithms.html">0501 - Decision trees based algorithms</a></li><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0502x_EXERCISE-5.1.html">0502x EXERCISE-5.1</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lessons</a></li><li><a class="is-disabled">JULIA2 - Scientific programming with Julia</a></li><li class="is-active"><a href="0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sylvaticus/SPMLJ" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sylvaticus/SPMLJ/blob/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/0202_-_Miscellaneous_topics.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><div id="ytb-videos">
<span style=font-weight:bold;>Videos related to this segment (click the title to watch)</span>
<details open><summary>02 JULIA2  - 2A:  Plotting (15:18)</summary>
<div class="container ytb-container">
    <div class="embed-responsive embed-responsive-16by9">
        <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/b-WkKMLd-Ws" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0"></iframe>
    </div>
</div>
</details>
<details ><summary>02 JULIA2  - 2B:  Probability distributions and data fitting (11:55)</summary>
<div class="container ytb-container">
    <div class="embed-responsive embed-responsive-16by9">
        <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/cfNXk2eiIFE" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0"></iframe>
    </div>
</div>
</details>
<details ><summary>02 JULIA2  - 2C:  Constrained optimisation, the transport problem (24:59)</summary>
<div class="container ytb-container">
    <div class="embed-responsive embed-responsive-16by9">
        <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/vxo7nOpnFSs" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0"></iframe>
    </div>
</div>
</details>
<details ><summary>02 JULIA2  - 2D:  Nonlinear constrained optimisation, the optimal portfolio allocation (16:4)</summary>
<div class="container ytb-container">
    <div class="embed-responsive embed-responsive-16by9">
        <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/_ypOlSwCC7U" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0"></iframe>
    </div>
</div>
</details>
</div><hr/><h1 id="0202-Miscellaneous-topics"><a class="docs-heading-anchor" href="#0202-Miscellaneous-topics">0202 - Miscellaneous topics</a><a id="0202-Miscellaneous-topics-1"></a><a class="docs-heading-anchor-permalink" href="#0202-Miscellaneous-topics" title="Permalink"></a></h1><h2 id="Some-stuff-to-set-up-the-environment.."><a class="docs-heading-anchor" href="#Some-stuff-to-set-up-the-environment..">Some stuff to set-up the environment..</a><a id="Some-stuff-to-set-up-the-environment..-1"></a><a class="docs-heading-anchor-permalink" href="#Some-stuff-to-set-up-the-environment.." title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; cd(@__DIR__)</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Pkg</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Pkg.activate(&quot;.&quot;)
       # If using a Julia version different than 1.10 please uncomment and run the following line (reproductibility guarantee will hower be lost)
       # Pkg.resolve()
       # Pkg.instantiate() # run this if you didn&#39;t in Segment 02.01</code><code class="nohighlight hljs ansi" style="display:block;">  Activating project at `~/work/SPMLJ/SPMLJ/buildedDoc/02_-_JULIA2_-_Scientific_programming_with_Julia`</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Random</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Random.seed!(123)</code><code class="nohighlight hljs ansi" style="display:block;">Random.TaskLocalRNG()</code></pre><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>Within the many possible packages to plot in Julia we use here the <code>Plots</code> package that allows at run time to choose the plot&#39;s backend. The defauld backend is <code>gr</code> (that, if you want to go back to it after you choosen another backend, you can activate with <code>gr()</code>). Other common backends are the Python MatplotLib (<code>pyplot()</code>, requiring package <code>PyPlot</code>) and Plotly (<code>plotlyjs()</code> from package <code>PlotlyJS</code>). Actually we use <code>StatsPlots</code> that just adds a set of convenient functionalities (in <code>plots</code> terminology called &quot;<em>recipes</em>&quot;) on top of <code>Plots</code>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StatsPlots # no need to `using Plots` as `Plots` elements are reexported by StatsPlots</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>The basic idea is that we can draw different &quot;graphical elements&quot; in a Plot figure. The <code>plot(.)</code> function will first create a new figure, while <code>plot!(.)</code> will modify an existing plot (by drawing new elements on it, such as a new serie) taking the &quot;current&quot; plot as default if no plot object is passed as first argument.</p><h3 id="Plotting-functions"><a class="docs-heading-anchor" href="#Plotting-functions">Plotting functions</a><a id="Plotting-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-functions" title="Permalink"></a></h3><p>Let&#39;s start plotting a function. The FIRST TIME you invoke <code>plot</code> will take a while. This is the famous &quot;time to first plot&quot; problem due to the JIT compilation, but it will materialize only on the first plotting in a working session</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(cos) # default [-5,+5] range</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code></pre><p><img src="currentPlot.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(x-&gt;x^2, -2,2 ) # more explicit, with ranges</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code></pre><p><img src="currentPlot1.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(x-&gt;max(x,2), label=&quot;max function&quot;, linestyle=:dot, color=:black, title=&quot;Chart title&quot;, xlabel= &quot;X axis&quot;, ylabel=&quot;Y axis&quot;, legend=:topleft) # a bit of design</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><p><img src="currentPlot2.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(twinx(),x-&gt;20x,colour=RGB(20/255,120/255,13/255)) # secondary axis</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=4}</code></pre><p><img src="currentPlot3.svg" alt/></p><h3 id="Plotting-data"><a class="docs-heading-anchor" href="#Plotting-data">Plotting data</a><a id="Plotting-data-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-data" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; x = 11:15</code><code class="nohighlight hljs ansi" style="display:block;">11:15</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = DataFrame(a=[4,8,6,6,3], b=[2,4,5,8,6], c=[20,40,15,5,30])</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">5×3 DataFrame
 Row │ a      b      c
     │<span class="sgr90"> Int64  Int64  Int64
─────┼─────────────────────
   1 │     4      2     20
   2 │     8      4     40
   3 │     6      5     15
   4 │     6      8      5
   5 │     3      6     30</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(x, Matrix(data)) # x, series (in column)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><p><img src="currentPlot4.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @df data plot(x, :a, seriestype=:bar, legend=:topleft)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code></pre><p><img src="currentPlot5.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(x, data.b, seriestype=:line)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code></pre><p><img src="currentPlot6.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; scatter!(twinx(), x, data.c) # alias for `plot!(..., seriestype=:scatter)`</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><p><img src="currentPlot7.svg" alt/></p><h3 id="Layouts-with-multiple-plots"><a class="docs-heading-anchor" href="#Layouts-with-multiple-plots">Layouts with multiple plots</a><a id="Layouts-with-multiple-plots-1"></a><a class="docs-heading-anchor-permalink" href="#Layouts-with-multiple-plots" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; l = @layout [a ; b c] # a,b,c, here are just placeholders, not related with the df column names..</code><code class="nohighlight hljs ansi" style="display:block;">2×1 Matrix{Any}:
 (label = :a, blank = false)
 Any[(label = :b, blank = false) (label = :c, blank = false)]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p1 = plot(x, data.a)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p2 = scatter(x, data.b)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p3 = plot(x, data.c)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(p1, p2, p3, layout = l)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><p><img src="currentPlot8.svg" alt/></p><h3 id="Saving-the-plot.."><a class="docs-heading-anchor" href="#Saving-the-plot..">Saving the plot..</a><a id="Saving-the-plot..-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-the-plot.." title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;myplot.png&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;/home/runner/work/SPMLJ/SPMLJ/buildedDoc/02_-_JULIA2_-_Scientific_programming_with_Julia/myplot.png&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;myplot.pdf&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;/home/runner/work/SPMLJ/SPMLJ/buildedDoc/02_-_JULIA2_-_Scientific_programming_with_Julia/myplot.pdf&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; savefig(&quot;myplot.svg&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;/home/runner/work/SPMLJ/SPMLJ/buildedDoc/02_-_JULIA2_-_Scientific_programming_with_Julia/myplot.svg&quot;</code></pre><h2 id="Probabilistic-analysis"><a class="docs-heading-anchor" href="#Probabilistic-analysis">Probabilistic analysis</a><a id="Probabilistic-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Probabilistic-analysis" title="Permalink"></a></h2><p>Julia has a very elegant package to deal with probability analysis, the <code>Distributions</code> package.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Distributions</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>The idea is that we first create a <code>Distribution</code> object, of the distribution family and with the parameter required, and then we operate on it, for example to sample or to retrieve a quantile. The following table gives the distribution constructors for some of the most common distributions:</p><table><tr><th style="text-align: right">Discrete distr.</th><th style="text-align: right">Constructor</th><th style="text-align: right">Continuous distr.</th><th style="text-align: right">Constructor</th></tr><tr><td style="text-align: right">Discrete uniform</td><td style="text-align: right"><code>DiscreteUniform(lRange,uRange)</code></td><td style="text-align: right">Uniform</td><td style="text-align: right"><code>Uniform(lRange,uRange)</code></td></tr><tr><td style="text-align: right">Bernoulli</td><td style="text-align: right"><code>Bernoulli(p)</code></td><td style="text-align: right">Exponential</td><td style="text-align: right"><code>Exponential(rate)</code></td></tr><tr><td style="text-align: right">Binomial</td><td style="text-align: right"><code>Binomial(n,p)</code></td><td style="text-align: right">Laplace</td><td style="text-align: right"><code>Laplace(loc, scale)</code></td></tr><tr><td style="text-align: right">Categorical</td><td style="text-align: right"><code>Categorical(ps)</code></td><td style="text-align: right">Normal</td><td style="text-align: right"><code>Normal(μ,σ)</code></td></tr><tr><td style="text-align: right">Multinomial</td><td style="text-align: right"><code>Multinomial(n, ps)</code></td><td style="text-align: right">Erlang</td><td style="text-align: right"><code>Erlang(n,rate)</code></td></tr><tr><td style="text-align: right">Geometric</td><td style="text-align: right"><code>Geometric(p)</code></td><td style="text-align: right">Cauchy</td><td style="text-align: right"><code>Cauchy(μ, σ)</code></td></tr><tr><td style="text-align: right">Hypergeometric</td><td style="text-align: right"><code>Hypergeometric(nS, nF, nTrials)</code></td><td style="text-align: right">Chisq</td><td style="text-align: right"><code>Chisq(df)</code></td></tr><tr><td style="text-align: right">Poisson</td><td style="text-align: right"><code>Poisson(rate)</code></td><td style="text-align: right">T Dist</td><td style="text-align: right"><code>TDist(df)</code></td></tr><tr><td style="text-align: right">Negative Binomial</td><td style="text-align: right"><code>NegativeBinomial(nSucc,p)</code></td><td style="text-align: right">F Dist</td><td style="text-align: right"><code>FDist(df1, df2)</code></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">Beta Dist</td><td style="text-align: right"><code>Beta(shapeα,shapeβ)</code></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">Gamma Dist</td><td style="text-align: right"><code>Gamma(shapeα,1/rateβ)</code></td></tr></table><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; d = Normal(10,3) # note that the parameter is the standard deviation, not the variance</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=10.0, σ=3.0)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mean(d)</code><code class="nohighlight hljs ansi" style="display:block;">10.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; var(d)</code><code class="nohighlight hljs ansi" style="display:block;">9.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; median(d)</code><code class="nohighlight hljs ansi" style="display:block;">10.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; quantile(d,0.9)</code><code class="nohighlight hljs ansi" style="display:block;">13.844654696633802</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; cdf(d,13.844)</code><code class="nohighlight hljs ansi" style="display:block;">0.8999616952550467</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pdf(d,0)</code><code class="nohighlight hljs ansi" style="display:block;">0.0005140929987637017</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rand(d,3,4,2)</code><code class="nohighlight hljs ansi" style="display:block;">3×4×2 Array{Float64, 3}:
[:, :, 1] =
 12.4249    8.74902   8.73469   9.64803
  6.63378  10.8628    5.93323  13.6578
  6.68609  10.6895   10.2084   10.8787

[:, :, 2] =
  9.90656   7.32977   9.04339  12.2951
 10.9475   12.5627    8.98764  10.5408
  3.51286  11.0253   16.0243   16.0867</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sample = rand(d,1000);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; density(sample)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code></pre><p><img src="currentPlot9.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(d)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code></pre><p><img src="currentPlot10.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; fit(Normal, sample) # using MLE</code><code class="nohighlight hljs ansi" style="display:block;">Distributions.Normal{Float64}(μ=10.130363752262184, σ=3.0557996927248805)</code></pre><p>For a quick overview on the various distributions available, the main methods that apply to them and a comparision with equivvalent R and Python libraries, you can see this cheatsheet: https://github.com/sylvaticus/commonDistributionsInJuliaPythonR</p><h2 id="Curve-fitting"><a class="docs-heading-anchor" href="#Curve-fitting">Curve fitting</a><a id="Curve-fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Curve-fitting" title="Permalink"></a></h2><p><code>LsqFit</code> is a very flexible data fitting package for linear and nonlinear arbitrary functions (using least squares). Let&#39;s use it to fit a logistic growth curve (Verhulst model) of volumes for a forest stand.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using LsqFit</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = DataFrame(
           age = 20:5:90,
           vol = [64,112,170,231,293,352,408,459,505,546,582,613,640,663,683]
       ) # Scots Pine, data from the UK Forestry Commission https://web.archive.org/web/20170119072737/http://forestry.gov.uk/pdf/FCBK048.pdf/$FILE/FCBK048.pdf</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">15×2 DataFrame
 Row │ age    vol
     │<span class="sgr90"> Int64  Int64
─────┼──────────────
   1 │    20     64
   2 │    25    112
   3 │    30    170
   4 │    35    231
   5 │    40    293
   6 │    45    352
   7 │    50    408
   8 │    55    459
   9 │    60    505
  10 │    65    546
  11 │    70    582
  12 │    75    613
  13 │    80    640
  14 │    85    663
  15 │    90    683</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(data.vol)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code></pre><p><img src="currentPlot11.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; logisticModel(age,parameters) = parameters[1]/(1+exp(-parameters[2] * (age-parameters[3]) ))</code><code class="nohighlight hljs ansi" style="display:block;">logisticModel (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; logisticModelVec(age,parameters) = logisticModel.(age,Ref(parameters))</code><code class="nohighlight hljs ansi" style="display:block;">logisticModelVec (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; initialParameters = [1000,0.02,50] #max growth; growth rate, mid age</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{Float64}:
 1000.0
    0.02
   50.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fitobject         = curve_fit(logisticModelVec, data.age, data.vol, initialParameters)</code><code class="nohighlight hljs ansi" style="display:block;">LsqFit.LsqFitResult{Vector{Float64}, Vector{Float64}, Matrix{Float64}, Vector{Int64}, Vector{LsqFit.LMState{LsqFit.LevenbergMarquardt}}}([692.5825413198176, 0.07303427530184728, 45.521079747040055], [28.97750654863104, 14.474712045689813, -1.3542656293281539, -11.572229993633243, -15.595058416636618, -12.297282501188477, -5.569946832007304, 2.589144258849501, 9.03778220094398, 12.04852281878334, 11.305933439776368, 7.516649845482561, 0.9186273616159042, -7.113657843007559, -16.307121770578988], [0.13424754596426883 -2054.332191201643 -5.878930833729613; 0.18261319698514056 -2121.443789792599 -7.550192857774018; … ; 0.9470154140969926 1371.9661652874784 -2.538077366652955; 0.9626186605328434 1108.4980035787337 -1.8201509196993966], true, Iter     Function value   Gradient norm
------   --------------   --------------
, Int64[])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fitparams         = fitobject.param</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{Float64}:
 692.5825413198176
   0.07303427530184728
  45.521079747040055</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fitobject.resid</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Float64}:
  28.97750654863104
  14.474712045689813
  -1.3542656293281539
 -11.572229993633243
 -15.595058416636618
 -12.297282501188477
  -5.569946832007304
   2.589144258849501
   9.03778220094398
  12.04852281878334
  11.305933439776368
   7.516649845482561
   0.9186273616159042
  -7.113657843007559
 -16.307121770578988</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; residuals = logisticModelVec(data.age,fitparams) .- data.vol</code><code class="nohighlight hljs ansi" style="display:block;">15-element Vector{Float64}:
  28.97750654863104
  14.474712045689813
  -1.3542656293281539
 -11.572229993633243
 -15.595058416636618
 -12.297282501188477
  -5.569946832007304
   2.589144258849501
   9.03778220094398
  12.04852281878334
  11.305933439776368
   7.516649845482561
   0.9186273616159042
  -7.113657843007559
 -16.307121770578988</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fitobject.resid == residuals</code><code class="nohighlight hljs ansi" style="display:block;">true</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sigma            = stderror(fitobject)</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{Float64}:
 12.682368775164093
  0.0035444978136088046
  0.7982532437259628</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; confidence_inter = confidence_interval(fitobject, 0.05) # 5% significance level</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{Tuple{Float64, Float64}}:
 (664.950033521919, 720.2150491177161)
 (0.06531147799082898, 0.08075707261286558)
 (43.78183533828645, 47.26032415579366)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; x = 0:maximum(data.age)*1.5</code><code class="nohighlight hljs ansi" style="display:block;">0.0:1.0:135.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(x-&gt;logisticModel(x,fitparams),0,maximum(x), label= &quot;Fitted vols&quot;, legend=:topleft)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(data.age, data.vol, seriestype=:scatter, label = &quot;Obs vols&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot!(data.age, residuals, seriestype=:bar, label = &quot;Residuals&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><p><img src="currentPlot12.svg" alt/></p><h2 id="Constrained-optimisation"><a class="docs-heading-anchor" href="#Constrained-optimisation">Constrained optimisation</a><a id="Constrained-optimisation-1"></a><a class="docs-heading-anchor-permalink" href="#Constrained-optimisation" title="Permalink"></a></h2><p><code>JuMP</code> is the leading library to express complex optimisation problems in a clear, mathematical friendly syntax, compute the information required by the solver engines to solve the optimisation problem, pass the problem to the aforementioned solver engines and retrieve the solutions.</p><p>JuMP has the same flexibility and expressivity of dedicated <em>algeabric modelling languages</em> as <code>GAMS</code> or <code>AMPL</code> but with the advantage of being a library within a much more general programming language, with larger community, development tools, language constructs and possibility to interface the specific &quot;optimisation component&quot; of a model with the rest of the model.</p><p>We will see how to specify the variables, the constraints and the objective function of an optimisation model, how to &quot;solve&quot; it and how to retrieve the optimal values</p><h3 id="A-linear-example:-the-classical-&quot;transport&quot;-problem"><a class="docs-heading-anchor" href="#A-linear-example:-the-classical-&quot;transport&quot;-problem">A linear example: the classical &quot;transport&quot; problem</a><a id="A-linear-example:-the-classical-&quot;transport&quot;-problem-1"></a><a class="docs-heading-anchor-permalink" href="#A-linear-example:-the-classical-&quot;transport&quot;-problem" title="Permalink"></a></h3><p>Obj: minimise transport costs <span>$c$</span> from several plants <span>$p$</span> to several markets <span>$m$</span> under the contraint to satisfy the demand <span>$d_m$</span> at each market while respecting the production capacity <span>$c_p$</span> of each plant: <span>$min_{x_{p,m}} \sum_p \sum_m c_{p,m} * x_{p,m}$</span> subject to: <span>$\sum_m x_{p,m} \leq d_m$</span> <span>$\sum_p x_{p,m} \geq c_m$</span></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using  JuMP, GLPK, DataFrames, CSV</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h4 id="&quot;Sets&quot;-and-exogenous-parameters-definition"><a class="docs-heading-anchor" href="#&quot;Sets&quot;-and-exogenous-parameters-definition">&quot;Sets&quot; and exogenous parameters definition</a><a id="&quot;Sets&quot;-and-exogenous-parameters-definition-1"></a><a class="docs-heading-anchor-permalink" href="#&quot;Sets&quot;-and-exogenous-parameters-definition" title="Permalink"></a></h4><p>index sets</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; orig = [&quot;Epinal&quot;, &quot;Bordeaux&quot;, &quot;Grenoble&quot;] # plant/sawmills origin of timber</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{String}:
 &quot;Epinal&quot;
 &quot;Bordeaux&quot;
 &quot;Grenoble&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dest = [&quot;Paris&quot;, &quot;Lyon&quot;, &quot;Nantes&quot;, &quot;Tulouse&quot;, &quot;Lille&quot;, &quot;Marseille&quot;, &quot;Strasbourg&quot;] # markets</code><code class="nohighlight hljs ansi" style="display:block;">7-element Vector{String}:
 &quot;Paris&quot;
 &quot;Lyon&quot;
 &quot;Nantes&quot;
 &quot;Tulouse&quot;
 &quot;Lille&quot;
 &quot;Marseille&quot;
 &quot;Strasbourg&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; prod = [&quot;Fuelwood&quot;, &quot;Sawnwood&quot;, &quot;Pannels&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{String}:
 &quot;Fuelwood&quot;
 &quot;Sawnwood&quot;
 &quot;Pannels&quot;</code></pre><p>Read input data into DataFrames and then into Dictionaries with 2D or 3D tuples of index sets as keys</p><p>supply(prod, orig) amounts available at origins</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; supplytable = CSV.read(IOBuffer(&quot;&quot;&quot;
       prod     Epinal Bordeaux Grenoble
       Fuelwood 400    700      800
       Sawnwood 800    1600     1800
       Pannels  200    300      300
       &quot;&quot;&quot;), DataFrame, delim=&quot; &quot;, ignorerepeated=true,copycols=true)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">3×4 DataFrame
 Row │ prod      Epinal  Bordeaux  Grenoble
     │<span class="sgr90"> String15  Int64   Int64     Int64
─────┼──────────────────────────────────────
   1 │ Fuelwood     400       700       800
   2 │ Sawnwood     800      1600      1800
   3 │ Pannels      200       300       300</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; supply = Dict( (r[:prod],o) =&gt; r[Symbol(o)] for r in eachrow(supplytable), o in orig)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Tuple{InlineStrings.String15, String}, Int64} with 9 entries:
  (&quot;Sawnwood&quot;, &quot;Bordeaux&quot;) =&gt; 1600
  (&quot;Sawnwood&quot;, &quot;Epinal&quot;)   =&gt; 800
  (&quot;Pannels&quot;, &quot;Epinal&quot;)    =&gt; 200
  (&quot;Pannels&quot;, &quot;Bordeaux&quot;)  =&gt; 300
  (&quot;Pannels&quot;, &quot;Grenoble&quot;)  =&gt; 300
  (&quot;Fuelwood&quot;, &quot;Epinal&quot;)   =&gt; 400
  (&quot;Fuelwood&quot;, &quot;Bordeaux&quot;) =&gt; 700
  (&quot;Fuelwood&quot;, &quot;Grenoble&quot;) =&gt; 800
  (&quot;Sawnwood&quot;, &quot;Grenoble&quot;) =&gt; 1800</code></pre><p>demand(prod, dest) amounts required at destinations</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; demandtable = CSV.read(IOBuffer(&quot;&quot;&quot;
       prod      Paris Lyon Nantes Tulouse Lille Marseille Strasbourg
       Fuelwood  300   300  100    75      650   225       250
       Sawnwood  500   750  400    250     950   850       500
       Pannels   100   100  0      50      200   100       250
       &quot;&quot;&quot;), DataFrame, delim=&quot; &quot;, ignorerepeated=true,copycols=true)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">3×8 DataFrame
 Row │ prod      Paris  Lyon   Nantes  Tulouse  Lille  Marseille  Strasbourg
     │<span class="sgr90"> String15  Int64  Int64  Int64   Int64    Int64  Int64      Int64
─────┼───────────────────────────────────────────────────────────────────────
   1 │ Fuelwood    300    300     100       75    650        225         250
   2 │ Sawnwood    500    750     400      250    950        850         500
   3 │ Pannels     100    100       0       50    200        100         250</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; demand = Dict( (r[:prod],d) =&gt; r[Symbol(d)] for r in eachrow(demandtable), d in dest)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Tuple{InlineStrings.String15, String}, Int64} with 21 entries:
  (&quot;Fuelwood&quot;, &quot;Paris&quot;)      =&gt; 300
  (&quot;Pannels&quot;, &quot;Paris&quot;)       =&gt; 100
  (&quot;Pannels&quot;, &quot;Lyon&quot;)        =&gt; 100
  (&quot;Sawnwood&quot;, &quot;Tulouse&quot;)    =&gt; 250
  (&quot;Fuelwood&quot;, &quot;Tulouse&quot;)    =&gt; 75
  (&quot;Fuelwood&quot;, &quot;Nantes&quot;)     =&gt; 100
  (&quot;Sawnwood&quot;, &quot;Lyon&quot;)       =&gt; 750
  (&quot;Pannels&quot;, &quot;Tulouse&quot;)     =&gt; 50
  (&quot;Fuelwood&quot;, &quot;Lille&quot;)      =&gt; 650
  (&quot;Pannels&quot;, &quot;Nantes&quot;)      =&gt; 0
  (&quot;Sawnwood&quot;, &quot;Lille&quot;)      =&gt; 950
  (&quot;Pannels&quot;, &quot;Marseille&quot;)   =&gt; 100
  (&quot;Fuelwood&quot;, &quot;Lyon&quot;)       =&gt; 300
  (&quot;Fuelwood&quot;, &quot;Strasbourg&quot;) =&gt; 250
  (&quot;Sawnwood&quot;, &quot;Paris&quot;)      =&gt; 500
  (&quot;Sawnwood&quot;, &quot;Nantes&quot;)     =&gt; 400
  (&quot;Fuelwood&quot;, &quot;Marseille&quot;)  =&gt; 225
  (&quot;Pannels&quot;, &quot;Strasbourg&quot;)  =&gt; 250
  (&quot;Sawnwood&quot;, &quot;Strasbourg&quot;) =&gt; 500
  ⋮                          =&gt; ⋮</code></pre><p>limit(orig, dest) of total units from any origin to destination</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; defaultlimit = 625.0</code><code class="nohighlight hljs ansi" style="display:block;">625.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; limit = Dict((o,d) =&gt; defaultlimit for o in orig, d in dest)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Tuple{String, String}, Float64} with 21 entries:
  (&quot;Bordeaux&quot;, &quot;Lyon&quot;)       =&gt; 625.0
  (&quot;Epinal&quot;, &quot;Lille&quot;)        =&gt; 625.0
  (&quot;Bordeaux&quot;, &quot;Marseille&quot;)  =&gt; 625.0
  (&quot;Epinal&quot;, &quot;Marseille&quot;)    =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Paris&quot;)      =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Marseille&quot;)  =&gt; 625.0
  (&quot;Bordeaux&quot;, &quot;Lille&quot;)      =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Tulouse&quot;)    =&gt; 625.0
  (&quot;Epinal&quot;, &quot;Strasbourg&quot;)   =&gt; 625.0
  (&quot;Epinal&quot;, &quot;Tulouse&quot;)      =&gt; 625.0
  (&quot;Bordeaux&quot;, &quot;Nantes&quot;)     =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Lille&quot;)      =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Nantes&quot;)     =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Lyon&quot;)       =&gt; 625.0
  (&quot;Bordeaux&quot;, &quot;Strasbourg&quot;) =&gt; 625.0
  (&quot;Grenoble&quot;, &quot;Strasbourg&quot;) =&gt; 625.0
  (&quot;Epinal&quot;, &quot;Nantes&quot;)       =&gt; 625.0
  (&quot;Epinal&quot;, &quot;Paris&quot;)        =&gt; 625.0
  (&quot;Bordeaux&quot;, &quot;Paris&quot;)      =&gt; 625.0
  ⋮                          =&gt; ⋮</code></pre><p>cost(prod, orig, dest) Shipment cost per unit</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; costtable = CSV.read(IOBuffer(&quot;&quot;&quot;
       prod     orig     Paris Lyon Nantes Tulouse Lille Marseille Strasbourg
       Fuelwood Epinal   30    10   8      10      11    71        6
       Fuelwood Bordeaux 22    7    10     7       21    82        13
       Fuelwood Grenoble 19    11   12     10      25    83        15
       
       Sawnwood Epinal   39    14   11     14      16    82        8
       Sawnwood Bordeaux 27    9    12     9       26    95        17
       Sawnwood Grenoble 24    14   17     13      28    99        20
       
       Pannels  Epinal   41    15   12     16      17    86        8
       Pannels  Bordeaux 29    9    13     9       28    99        18
       Pannels  Grenoble 26    14   17     13      31    104       20
       &quot;&quot;&quot;), DataFrame, delim=&quot; &quot;, ignorerepeated=true,copycols=true)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">9×9 DataFrame
 Row │ prod      orig      Paris  Lyon   Nantes  Tulouse  Lille  Marseille  St ⋯
     │<span class="sgr90"> String15  String15  Int64  Int64  Int64   Int64    Int64  Int64      In ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ Fuelwood  Epinal       30     10       8       10     11         71     ⋯
   2 │ Fuelwood  Bordeaux     22      7      10        7     21         82
   3 │ Fuelwood  Grenoble     19     11      12       10     25         83
   4 │ Sawnwood  Epinal       39     14      11       14     16         82
   5 │ Sawnwood  Bordeaux     27      9      12        9     26         95     ⋯
   6 │ Sawnwood  Grenoble     24     14      17       13     28         99
   7 │ Pannels   Epinal       41     15      12       16     17         86
   8 │ Pannels   Bordeaux     29      9      13        9     28         99
   9 │ Pannels   Grenoble     26     14      17       13     31        104     ⋯
</span><span class="sgr36">                                                                1 column omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; cost = Dict( (r[:prod],r[:orig],d) =&gt; r[Symbol(d)] for r in eachrow(costtable), d in dest)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Tuple{InlineStrings.String15, InlineStrings.String15, String}, Int64} with 63 entries:
  (&quot;Sawnwood&quot;, &quot;Epinal&quot;, &quot;Lille&quot;)        =&gt; 16
  (&quot;Sawnwood&quot;, &quot;Epinal&quot;, &quot;Paris&quot;)        =&gt; 39
  (&quot;Sawnwood&quot;, &quot;Bordeaux&quot;, &quot;Lyon&quot;)       =&gt; 9
  (&quot;Sawnwood&quot;, &quot;Epinal&quot;, &quot;Lyon&quot;)         =&gt; 14
  (&quot;Sawnwood&quot;, &quot;Bordeaux&quot;, &quot;Strasbourg&quot;) =&gt; 17
  (&quot;Fuelwood&quot;, &quot;Bordeaux&quot;, &quot;Tulouse&quot;)    =&gt; 7
  (&quot;Fuelwood&quot;, &quot;Bordeaux&quot;, &quot;Lille&quot;)      =&gt; 21
  (&quot;Fuelwood&quot;, &quot;Grenoble&quot;, &quot;Strasbourg&quot;) =&gt; 15
  (&quot;Sawnwood&quot;, &quot;Grenoble&quot;, &quot;Strasbourg&quot;) =&gt; 20
  (&quot;Fuelwood&quot;, &quot;Grenoble&quot;, &quot;Lyon&quot;)       =&gt; 11
  (&quot;Fuelwood&quot;, &quot;Bordeaux&quot;, &quot;Lyon&quot;)       =&gt; 7
  (&quot;Sawnwood&quot;, &quot;Grenoble&quot;, &quot;Lille&quot;)      =&gt; 28
  (&quot;Pannels&quot;, &quot;Bordeaux&quot;, &quot;Tulouse&quot;)     =&gt; 9
  (&quot;Fuelwood&quot;, &quot;Grenoble&quot;, &quot;Nantes&quot;)     =&gt; 12
  (&quot;Pannels&quot;, &quot;Epinal&quot;, &quot;Lyon&quot;)          =&gt; 15
  (&quot;Sawnwood&quot;, &quot;Bordeaux&quot;, &quot;Tulouse&quot;)    =&gt; 9
  (&quot;Pannels&quot;, &quot;Bordeaux&quot;, &quot;Paris&quot;)       =&gt; 29
  (&quot;Fuelwood&quot;, &quot;Bordeaux&quot;, &quot;Paris&quot;)      =&gt; 22
  (&quot;Sawnwood&quot;, &quot;Epinal&quot;, &quot;Nantes&quot;)       =&gt; 11
  ⋮                                      =&gt; ⋮</code></pre><h4 id="Optimisation-model-definition"><a class="docs-heading-anchor" href="#Optimisation-model-definition">Optimisation model definition</a><a id="Optimisation-model-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Optimisation-model-definition" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; trmodel = Model(GLPK.Optimizer)</code><code class="nohighlight hljs ansi" style="display:block;">A JuMP Model
Feasibility problem with:
Variables: 0
Model mode: AUTOMATIC
CachingOptimizer state: EMPTY_OPTIMIZER
Solver name: GLPK</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; set_optimizer_attribute(trmodel, &quot;msg_lev&quot;, GLPK.GLP_MSG_ON)</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><div class="admonition is-success"><header class="admonition-header">...</header><div class="admonition-body"><p>Alternativelly, you can use <code>HiGHS</code> as another popular choice for linear solver engine</p></div></div><h4 id="Model&#39;s-endogenous-variables-definition"><a class="docs-heading-anchor" href="#Model&#39;s-endogenous-variables-definition">Model&#39;s endogenous variables definition</a><a id="Model&#39;s-endogenous-variables-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Model&#39;s-endogenous-variables-definition" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @variables trmodel begin
           x[p in prod, o in orig, d in dest] &gt;= 0
       end;</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h4 id="Constraints-definition"><a class="docs-heading-anchor" href="#Constraints-definition">Constraints definition</a><a id="Constraints-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Constraints-definition" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @constraints trmodel begin
           supply[p in prod, o in orig], # observe supply limit at plant/sawmill origin o
               sum(x[p,o,d] for d in dest) &lt;= supply[p,o]
           demand[p in prod, d in dest], # satisfy demand at market dest d
               sum(x[p,o,d] for o in orig) &gt;= demand[p,d]
           c_total_shipment[o in orig, d in dest],
               sum(x[p,o,d] for p in prod) &lt;= limit[o,d]
       end;</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h4 id="Objective-function-definition"><a class="docs-heading-anchor" href="#Objective-function-definition">Objective function definition</a><a id="Objective-function-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Objective-function-definition" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @objective trmodel Min begin
           sum(cost[p,o,d] * x[p,o,d] for p in prod, o in orig, d in dest)
       end</code><code class="nohighlight hljs ansi" style="display:block;">30 x[Fuelwood,Epinal,Paris] + 39 x[Sawnwood,Epinal,Paris] + 41 x[Pannels,Epinal,Paris] + 22 x[Fuelwood,Bordeaux,Paris] + 27 x[Sawnwood,Bordeaux,Paris] + 29 x[Pannels,Bordeaux,Paris] + 19 x[Fuelwood,Grenoble,Paris] + 24 x[Sawnwood,Grenoble,Paris] + 26 x[Pannels,Grenoble,Paris] + 10 x[Fuelwood,Epinal,Lyon] + 14 x[Sawnwood,Epinal,Lyon] + 15 x[Pannels,Epinal,Lyon] + 7 x[Fuelwood,Bordeaux,Lyon] + 9 x[Sawnwood,Bordeaux,Lyon] + 9 x[Pannels,Bordeaux,Lyon] + 11 x[Fuelwood,Grenoble,Lyon] + 14 x[Sawnwood,Grenoble,Lyon] + 14 x[Pannels,Grenoble,Lyon] + 8 x[Fuelwood,Epinal,Nantes] + 11 x[Sawnwood,Epinal,Nantes] + 12 x[Pannels,Epinal,Nantes] + 10 x[Fuelwood,Bordeaux,Nantes] + 12 x[Sawnwood,Bordeaux,Nantes] + 13 x[Pannels,Bordeaux,Nantes] + 12 x[Fuelwood,Grenoble,Nantes] + 17 x[Sawnwood,Grenoble,Nantes] + 17 x[Pannels,Grenoble,Nantes] + 10 x[Fuelwood,Epinal,Tulouse] + 14 x[Sawnwood,Epinal,Tulouse] + 16 x[Pannels,Epinal,Tulouse] + [[...3 terms omitted...]] + 10 x[Fuelwood,Grenoble,Tulouse] + 13 x[Sawnwood,Grenoble,Tulouse] + 13 x[Pannels,Grenoble,Tulouse] + 11 x[Fuelwood,Epinal,Lille] + 16 x[Sawnwood,Epinal,Lille] + 17 x[Pannels,Epinal,Lille] + 21 x[Fuelwood,Bordeaux,Lille] + 26 x[Sawnwood,Bordeaux,Lille] + 28 x[Pannels,Bordeaux,Lille] + 25 x[Fuelwood,Grenoble,Lille] + 28 x[Sawnwood,Grenoble,Lille] + 31 x[Pannels,Grenoble,Lille] + 71 x[Fuelwood,Epinal,Marseille] + 82 x[Sawnwood,Epinal,Marseille] + 86 x[Pannels,Epinal,Marseille] + 82 x[Fuelwood,Bordeaux,Marseille] + 95 x[Sawnwood,Bordeaux,Marseille] + 99 x[Pannels,Bordeaux,Marseille] + 83 x[Fuelwood,Grenoble,Marseille] + 99 x[Sawnwood,Grenoble,Marseille] + 104 x[Pannels,Grenoble,Marseille] + 6 x[Fuelwood,Epinal,Strasbourg] + 8 x[Sawnwood,Epinal,Strasbourg] + 8 x[Pannels,Epinal,Strasbourg] + 13 x[Fuelwood,Bordeaux,Strasbourg] + 17 x[Sawnwood,Bordeaux,Strasbourg] + 18 x[Pannels,Bordeaux,Strasbourg] + 15 x[Fuelwood,Grenoble,Strasbourg] + 20 x[Sawnwood,Grenoble,Strasbourg] + 20 x[Pannels,Grenoble,Strasbourg]</code></pre><h4 id="Human-readable-visualisation-of-the-model"><a class="docs-heading-anchor" href="#Human-readable-visualisation-of-the-model">Human-readable visualisation of the model</a><a id="Human-readable-visualisation-of-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#Human-readable-visualisation-of-the-model" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; print(trmodel)</code><code class="nohighlight hljs ansi" style="display:block;">Min 30 x[Fuelwood,Epinal,Paris] + 39 x[Sawnwood,Epinal,Paris] + 41 x[Pannels,Epinal,Paris] + 22 x[Fuelwood,Bordeaux,Paris] + 27 x[Sawnwood,Bordeaux,Paris] + 29 x[Pannels,Bordeaux,Paris] + 19 x[Fuelwood,Grenoble,Paris] + 24 x[Sawnwood,Grenoble,Paris] + 26 x[Pannels,Grenoble,Paris] + 10 x[Fuelwood,Epinal,Lyon] + 14 x[Sawnwood,Epinal,Lyon] + 15 x[Pannels,Epinal,Lyon] + 7 x[Fuelwood,Bordeaux,Lyon] + 9 x[Sawnwood,Bordeaux,Lyon] + 9 x[Pannels,Bordeaux,Lyon] + 11 x[Fuelwood,Grenoble,Lyon] + 14 x[Sawnwood,Grenoble,Lyon] + 14 x[Pannels,Grenoble,Lyon] + 8 x[Fuelwood,Epinal,Nantes] + 11 x[Sawnwood,Epinal,Nantes] + 12 x[Pannels,Epinal,Nantes] + 10 x[Fuelwood,Bordeaux,Nantes] + 12 x[Sawnwood,Bordeaux,Nantes] + 13 x[Pannels,Bordeaux,Nantes] + 12 x[Fuelwood,Grenoble,Nantes] + 17 x[Sawnwood,Grenoble,Nantes] + 17 x[Pannels,Grenoble,Nantes] + 10 x[Fuelwood,Epinal,Tulouse] + 14 x[Sawnwood,Epinal,Tulouse] + 16 x[Pannels,Epinal,Tulouse] + [[...3 terms omitted...]] + 10 x[Fuelwood,Grenoble,Tulouse] + 13 x[Sawnwood,Grenoble,Tulouse] + 13 x[Pannels,Grenoble,Tulouse] + 11 x[Fuelwood,Epinal,Lille] + 16 x[Sawnwood,Epinal,Lille] + 17 x[Pannels,Epinal,Lille] + 21 x[Fuelwood,Bordeaux,Lille] + 26 x[Sawnwood,Bordeaux,Lille] + 28 x[Pannels,Bordeaux,Lille] + 25 x[Fuelwood,Grenoble,Lille] + 28 x[Sawnwood,Grenoble,Lille] + 31 x[Pannels,Grenoble,Lille] + 71 x[Fuelwood,Epinal,Marseille] + 82 x[Sawnwood,Epinal,Marseille] + 86 x[Pannels,Epinal,Marseille] + 82 x[Fuelwood,Bordeaux,Marseille] + 95 x[Sawnwood,Bordeaux,Marseille] + 99 x[Pannels,Bordeaux,Marseille] + 83 x[Fuelwood,Grenoble,Marseille] + 99 x[Sawnwood,Grenoble,Marseille] + 104 x[Pannels,Grenoble,Marseille] + 6 x[Fuelwood,Epinal,Strasbourg] + 8 x[Sawnwood,Epinal,Strasbourg] + 8 x[Pannels,Epinal,Strasbourg] + 13 x[Fuelwood,Bordeaux,Strasbourg] + 17 x[Sawnwood,Bordeaux,Strasbourg] + 18 x[Pannels,Bordeaux,Strasbourg] + 15 x[Fuelwood,Grenoble,Strasbourg] + 20 x[Sawnwood,Grenoble,Strasbourg] + 20 x[Pannels,Grenoble,Strasbourg]
Subject to
 demand[Fuelwood,Paris] : x[Fuelwood,Epinal,Paris] + x[Fuelwood,Bordeaux,Paris] + x[Fuelwood,Grenoble,Paris] ≥ 300
 demand[Sawnwood,Paris] : x[Sawnwood,Epinal,Paris] + x[Sawnwood,Bordeaux,Paris] + x[Sawnwood,Grenoble,Paris] ≥ 500
 demand[Pannels,Paris] : x[Pannels,Epinal,Paris] + x[Pannels,Bordeaux,Paris] + x[Pannels,Grenoble,Paris] ≥ 100
 demand[Fuelwood,Lyon] : x[Fuelwood,Epinal,Lyon] + x[Fuelwood,Bordeaux,Lyon] + x[Fuelwood,Grenoble,Lyon] ≥ 300
 demand[Sawnwood,Lyon] : x[Sawnwood,Epinal,Lyon] + x[Sawnwood,Bordeaux,Lyon] + x[Sawnwood,Grenoble,Lyon] ≥ 750
 demand[Pannels,Lyon] : x[Pannels,Epinal,Lyon] + x[Pannels,Bordeaux,Lyon] + x[Pannels,Grenoble,Lyon] ≥ 100
 demand[Fuelwood,Nantes] : x[Fuelwood,Epinal,Nantes] + x[Fuelwood,Bordeaux,Nantes] + x[Fuelwood,Grenoble,Nantes] ≥ 100
 demand[Sawnwood,Nantes] : x[Sawnwood,Epinal,Nantes] + x[Sawnwood,Bordeaux,Nantes] + x[Sawnwood,Grenoble,Nantes] ≥ 400
 demand[Pannels,Nantes] : x[Pannels,Epinal,Nantes] + x[Pannels,Bordeaux,Nantes] + x[Pannels,Grenoble,Nantes] ≥ 0
 demand[Fuelwood,Tulouse] : x[Fuelwood,Epinal,Tulouse] + x[Fuelwood,Bordeaux,Tulouse] + x[Fuelwood,Grenoble,Tulouse] ≥ 75
 demand[Sawnwood,Tulouse] : x[Sawnwood,Epinal,Tulouse] + x[Sawnwood,Bordeaux,Tulouse] + x[Sawnwood,Grenoble,Tulouse] ≥ 250
 demand[Pannels,Tulouse] : x[Pannels,Epinal,Tulouse] + x[Pannels,Bordeaux,Tulouse] + x[Pannels,Grenoble,Tulouse] ≥ 50
 demand[Fuelwood,Lille] : x[Fuelwood,Epinal,Lille] + x[Fuelwood,Bordeaux,Lille] + x[Fuelwood,Grenoble,Lille] ≥ 650
 demand[Sawnwood,Lille] : x[Sawnwood,Epinal,Lille] + x[Sawnwood,Bordeaux,Lille] + x[Sawnwood,Grenoble,Lille] ≥ 950
 demand[Pannels,Lille] : x[Pannels,Epinal,Lille] + x[Pannels,Bordeaux,Lille] + x[Pannels,Grenoble,Lille] ≥ 200
 demand[Fuelwood,Marseille] : x[Fuelwood,Epinal,Marseille] + x[Fuelwood,Bordeaux,Marseille] + x[Fuelwood,Grenoble,Marseille] ≥ 225
 demand[Sawnwood,Marseille] : x[Sawnwood,Epinal,Marseille] + x[Sawnwood,Bordeaux,Marseille] + x[Sawnwood,Grenoble,Marseille] ≥ 850
 demand[Pannels,Marseille] : x[Pannels,Epinal,Marseille] + x[Pannels,Bordeaux,Marseille] + x[Pannels,Grenoble,Marseille] ≥ 100
 demand[Fuelwood,Strasbourg] : x[Fuelwood,Epinal,Strasbourg] + x[Fuelwood,Bordeaux,Strasbourg] + x[Fuelwood,Grenoble,Strasbourg] ≥ 250
 demand[Sawnwood,Strasbourg] : x[Sawnwood,Epinal,Strasbourg] + x[Sawnwood,Bordeaux,Strasbourg] + x[Sawnwood,Grenoble,Strasbourg] ≥ 500
 demand[Pannels,Strasbourg] : x[Pannels,Epinal,Strasbourg] + x[Pannels,Bordeaux,Strasbourg] + x[Pannels,Grenoble,Strasbourg] ≥ 250
 supply[Fuelwood,Epinal] : x[Fuelwood,Epinal,Paris] + x[Fuelwood,Epinal,Lyon] + x[Fuelwood,Epinal,Nantes] + x[Fuelwood,Epinal,Tulouse] + x[Fuelwood,Epinal,Lille] + x[Fuelwood,Epinal,Marseille] + x[Fuelwood,Epinal,Strasbourg] ≤ 400
 supply[Sawnwood,Epinal] : x[Sawnwood,Epinal,Paris] + x[Sawnwood,Epinal,Lyon] + x[Sawnwood,Epinal,Nantes] + x[Sawnwood,Epinal,Tulouse] + x[Sawnwood,Epinal,Lille] + x[Sawnwood,Epinal,Marseille] + x[Sawnwood,Epinal,Strasbourg] ≤ 800
 supply[Pannels,Epinal] : x[Pannels,Epinal,Paris] + x[Pannels,Epinal,Lyon] + x[Pannels,Epinal,Nantes] + x[Pannels,Epinal,Tulouse] + x[Pannels,Epinal,Lille] + x[Pannels,Epinal,Marseille] + x[Pannels,Epinal,Strasbourg] ≤ 200
 supply[Fuelwood,Bordeaux] : x[Fuelwood,Bordeaux,Paris] + x[Fuelwood,Bordeaux,Lyon] + x[Fuelwood,Bordeaux,Nantes] + x[Fuelwood,Bordeaux,Tulouse] + x[Fuelwood,Bordeaux,Lille] + x[Fuelwood,Bordeaux,Marseille] + x[Fuelwood,Bordeaux,Strasbourg] ≤ 700
 supply[Sawnwood,Bordeaux] : x[Sawnwood,Bordeaux,Paris] + x[Sawnwood,Bordeaux,Lyon] + x[Sawnwood,Bordeaux,Nantes] + x[Sawnwood,Bordeaux,Tulouse] + x[Sawnwood,Bordeaux,Lille] + x[Sawnwood,Bordeaux,Marseille] + x[Sawnwood,Bordeaux,Strasbourg] ≤ 1600
 supply[Pannels,Bordeaux] : x[Pannels,Bordeaux,Paris] + x[Pannels,Bordeaux,Lyon] + x[Pannels,Bordeaux,Nantes] + x[Pannels,Bordeaux,Tulouse] + x[Pannels,Bordeaux,Lille] + x[Pannels,Bordeaux,Marseille] + x[Pannels,Bordeaux,Strasbourg] ≤ 300
 supply[Fuelwood,Grenoble] : x[Fuelwood,Grenoble,Paris] + x[Fuelwood,Grenoble,Lyon] + x[Fuelwood,Grenoble,Nantes] + x[Fuelwood,Grenoble,Tulouse] + x[Fuelwood,Grenoble,Lille] + x[Fuelwood,Grenoble,Marseille] + x[Fuelwood,Grenoble,Strasbourg] ≤ 800
 supply[Sawnwood,Grenoble] : x[Sawnwood,Grenoble,Paris] + x[Sawnwood,Grenoble,Lyon] + x[Sawnwood,Grenoble,Nantes] + x[Sawnwood,Grenoble,Tulouse] + x[Sawnwood,Grenoble,Lille] + x[Sawnwood,Grenoble,Marseille] + x[Sawnwood,Grenoble,Strasbourg] ≤ 1800
 supply[Pannels,Grenoble] : x[Pannels,Grenoble,Paris] + x[Pannels,Grenoble,Lyon] + x[Pannels,Grenoble,Nantes] + x[Pannels,Grenoble,Tulouse] + x[Pannels,Grenoble,Lille] + x[Pannels,Grenoble,Marseille] + x[Pannels,Grenoble,Strasbourg] ≤ 300
 c_total_shipment[Epinal,Paris] : x[Fuelwood,Epinal,Paris] + x[Sawnwood,Epinal,Paris] + x[Pannels,Epinal,Paris] ≤ 625
 c_total_shipment[Bordeaux,Paris] : x[Fuelwood,Bordeaux,Paris] + x[Sawnwood,Bordeaux,Paris] + x[Pannels,Bordeaux,Paris] ≤ 625
 c_total_shipment[Grenoble,Paris] : x[Fuelwood,Grenoble,Paris] + x[Sawnwood,Grenoble,Paris] + x[Pannels,Grenoble,Paris] ≤ 625
 c_total_shipment[Epinal,Lyon] : x[Fuelwood,Epinal,Lyon] + x[Sawnwood,Epinal,Lyon] + x[Pannels,Epinal,Lyon] ≤ 625
 c_total_shipment[Bordeaux,Lyon] : x[Fuelwood,Bordeaux,Lyon] + x[Sawnwood,Bordeaux,Lyon] + x[Pannels,Bordeaux,Lyon] ≤ 625
 c_total_shipment[Grenoble,Lyon] : x[Fuelwood,Grenoble,Lyon] + x[Sawnwood,Grenoble,Lyon] + x[Pannels,Grenoble,Lyon] ≤ 625
 c_total_shipment[Epinal,Nantes] : x[Fuelwood,Epinal,Nantes] + x[Sawnwood,Epinal,Nantes] + x[Pannels,Epinal,Nantes] ≤ 625
 c_total_shipment[Bordeaux,Nantes] : x[Fuelwood,Bordeaux,Nantes] + x[Sawnwood,Bordeaux,Nantes] + x[Pannels,Bordeaux,Nantes] ≤ 625
 c_total_shipment[Grenoble,Nantes] : x[Fuelwood,Grenoble,Nantes] + x[Sawnwood,Grenoble,Nantes] + x[Pannels,Grenoble,Nantes] ≤ 625
 c_total_shipment[Epinal,Tulouse] : x[Fuelwood,Epinal,Tulouse] + x[Sawnwood,Epinal,Tulouse] + x[Pannels,Epinal,Tulouse] ≤ 625
 c_total_shipment[Bordeaux,Tulouse] : x[Fuelwood,Bordeaux,Tulouse] + x[Sawnwood,Bordeaux,Tulouse] + x[Pannels,Bordeaux,Tulouse] ≤ 625
 c_total_shipment[Grenoble,Tulouse] : x[Fuelwood,Grenoble,Tulouse] + x[Sawnwood,Grenoble,Tulouse] + x[Pannels,Grenoble,Tulouse] ≤ 625
 c_total_shipment[Epinal,Lille] : x[Fuelwood,Epinal,Lille] + x[Sawnwood,Epinal,Lille] + x[Pannels,Epinal,Lille] ≤ 625
 c_total_shipment[Bordeaux,Lille] : x[Fuelwood,Bordeaux,Lille] + x[Sawnwood,Bordeaux,Lille] + x[Pannels,Bordeaux,Lille] ≤ 625
 c_total_shipment[Grenoble,Lille] : x[Fuelwood,Grenoble,Lille] + x[Sawnwood,Grenoble,Lille] + x[Pannels,Grenoble,Lille] ≤ 625
 c_total_shipment[Epinal,Marseille] : x[Fuelwood,Epinal,Marseille] + x[Sawnwood,Epinal,Marseille] + x[Pannels,Epinal,Marseille] ≤ 625
 c_total_shipment[Bordeaux,Marseille] : x[Fuelwood,Bordeaux,Marseille] + x[Sawnwood,Bordeaux,Marseille] + x[Pannels,Bordeaux,Marseille] ≤ 625
 c_total_shipment[Grenoble,Marseille] : x[Fuelwood,Grenoble,Marseille] + x[Sawnwood,Grenoble,Marseille] + x[Pannels,Grenoble,Marseille] ≤ 625
 c_total_shipment[Epinal,Strasbourg] : x[Fuelwood,Epinal,Strasbourg] + x[Sawnwood,Epinal,Strasbourg] + x[Pannels,Epinal,Strasbourg] ≤ 625
 c_total_shipment[Bordeaux,Strasbourg] : x[Fuelwood,Bordeaux,Strasbourg] + x[Sawnwood,Bordeaux,Strasbourg] + x[Pannels,Bordeaux,Strasbourg] ≤ 625
[[...14 constraints skipped...]]
 x[Sawnwood,Bordeaux,Lyon] ≥ 0
 x[Pannels,Bordeaux,Lyon] ≥ 0
 x[Fuelwood,Grenoble,Lyon] ≥ 0
 x[Sawnwood,Grenoble,Lyon] ≥ 0
 x[Pannels,Grenoble,Lyon] ≥ 0
 x[Fuelwood,Epinal,Nantes] ≥ 0
 x[Sawnwood,Epinal,Nantes] ≥ 0
 x[Pannels,Epinal,Nantes] ≥ 0
 x[Fuelwood,Bordeaux,Nantes] ≥ 0
 x[Sawnwood,Bordeaux,Nantes] ≥ 0
 x[Pannels,Bordeaux,Nantes] ≥ 0
 x[Fuelwood,Grenoble,Nantes] ≥ 0
 x[Sawnwood,Grenoble,Nantes] ≥ 0
 x[Pannels,Grenoble,Nantes] ≥ 0
 x[Fuelwood,Epinal,Tulouse] ≥ 0
 x[Sawnwood,Epinal,Tulouse] ≥ 0
 x[Pannels,Epinal,Tulouse] ≥ 0
 x[Fuelwood,Bordeaux,Tulouse] ≥ 0
 x[Sawnwood,Bordeaux,Tulouse] ≥ 0
 x[Pannels,Bordeaux,Tulouse] ≥ 0
 x[Fuelwood,Grenoble,Tulouse] ≥ 0
 x[Sawnwood,Grenoble,Tulouse] ≥ 0
 x[Pannels,Grenoble,Tulouse] ≥ 0
 x[Fuelwood,Epinal,Lille] ≥ 0
 x[Sawnwood,Epinal,Lille] ≥ 0
 x[Pannels,Epinal,Lille] ≥ 0
 x[Fuelwood,Bordeaux,Lille] ≥ 0
 x[Sawnwood,Bordeaux,Lille] ≥ 0
 x[Pannels,Bordeaux,Lille] ≥ 0
 x[Fuelwood,Grenoble,Lille] ≥ 0
 x[Sawnwood,Grenoble,Lille] ≥ 0
 x[Pannels,Grenoble,Lille] ≥ 0
 x[Fuelwood,Epinal,Marseille] ≥ 0
 x[Sawnwood,Epinal,Marseille] ≥ 0
 x[Pannels,Epinal,Marseille] ≥ 0
 x[Fuelwood,Bordeaux,Marseille] ≥ 0
 x[Sawnwood,Bordeaux,Marseille] ≥ 0
 x[Pannels,Bordeaux,Marseille] ≥ 0
 x[Fuelwood,Grenoble,Marseille] ≥ 0
 x[Sawnwood,Grenoble,Marseille] ≥ 0
 x[Pannels,Grenoble,Marseille] ≥ 0
 x[Fuelwood,Epinal,Strasbourg] ≥ 0
 x[Sawnwood,Epinal,Strasbourg] ≥ 0
 x[Pannels,Epinal,Strasbourg] ≥ 0
 x[Fuelwood,Bordeaux,Strasbourg] ≥ 0
 x[Sawnwood,Bordeaux,Strasbourg] ≥ 0
 x[Pannels,Bordeaux,Strasbourg] ≥ 0
 x[Fuelwood,Grenoble,Strasbourg] ≥ 0
 x[Sawnwood,Grenoble,Strasbourg] ≥ 0
 x[Pannels,Grenoble,Strasbourg] ≥ 0</code></pre><h4 id="Model-resolution"><a class="docs-heading-anchor" href="#Model-resolution">Model resolution</a><a id="Model-resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Model-resolution" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; optimize!(trmodel)</code><code class="nohighlight hljs ansi" style="display:block;">      0: obj =   0.000000000e+00 inf =   6.900e+03 (20)
     38: obj =   2.172000000e+05 inf =   0.000e+00 (0)
*    59: obj =   1.995000000e+05 inf =   0.000e+00 (0)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; status = termination_status(trmodel)</code><code class="nohighlight hljs ansi" style="display:block;">OPTIMAL::TerminationStatusCode = 1</code></pre><h4 id="Post-resolution-information-retrieval"><a class="docs-heading-anchor" href="#Post-resolution-information-retrieval">Post-resolution information retrieval</a><a id="Post-resolution-information-retrieval-1"></a><a class="docs-heading-anchor-permalink" href="#Post-resolution-information-retrieval" title="Permalink"></a></h4><p>Here, after the model has been &quot;solved&quot;, we can retrieve information as the optimal level of the endogenous variables, the value of the opjective function at these optimal levels and the shadow costs of the contraints.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; if (status == MOI.OPTIMAL || status == MOI.LOCALLY_SOLVED || status == MOI.TIME_LIMIT) &amp;&amp; has_values(trmodel)
           println(&quot;#################################################################&quot;)
           if (status == MOI.OPTIMAL)
               println(&quot;** Problem solved correctly **&quot;)
           else
               println(&quot;** Problem returned a (possibly suboptimal) solution **&quot;)
           end
           println(&quot;- Objective value (total costs): &quot;, objective_value(trmodel))
           println(&quot;- Optimal routes:\n&quot;)
           optRoutes = value.(x)
           for p in prod
             println(&quot;\n* $(p):&quot;)
             [println(&quot;$o --&gt; $d: $(optRoutes[p,o,d])&quot;) for o in orig, d in dest]
             println(&quot;- Shadow prices of supply:&quot;)
             [println(&quot;$o = $(dual(supply[p,o]))&quot;) for o in orig]
             println(&quot;- Shadow prices of demand:&quot;)
             [println(&quot;$d = $(dual(demand[p,d]))&quot;) for d in dest]
           end
       else
           println(&quot;The model was not solved correctly.&quot;)
           println(status)
       end</code><code class="nohighlight hljs ansi" style="display:block;">#################################################################
** Problem solved correctly **
- Objective value (total costs): 199500.0
- Optimal routes:


* Fuelwood:
Epinal --&gt; Paris: 0.0
Bordeaux --&gt; Paris: 225.0
Grenoble --&gt; Paris: 75.0
Epinal --&gt; Lyon: 0.0
Bordeaux --&gt; Lyon: 150.0
Grenoble --&gt; Lyon: 150.0
Epinal --&gt; Nantes: 0.0
Bordeaux --&gt; Nantes: 0.0
Grenoble --&gt; Nantes: 100.0
Epinal --&gt; Tulouse: 0.0
Bordeaux --&gt; Tulouse: 75.0
Grenoble --&gt; Tulouse: 0.0
Epinal --&gt; Lille: 400.0
Bordeaux --&gt; Lille: 250.0
Grenoble --&gt; Lille: 0.0
Epinal --&gt; Marseille: 0.0
Bordeaux --&gt; Marseille: 0.0
Grenoble --&gt; Marseille: 225.0
Epinal --&gt; Strasbourg: 0.0
Bordeaux --&gt; Strasbourg: 0.0
Grenoble --&gt; Strasbourg: 250.0
- Shadow prices of supply:
Epinal = -12.0
Bordeaux = -3.0
Grenoble = 0.0
- Shadow prices of demand:
Paris = 25.0
Lyon = 11.0
Nantes = 12.0
Tulouse = 10.0
Lille = 24.0
Marseille = 83.0
Strasbourg = 16.0

* Sawnwood:
Epinal --&gt; Paris: 0.0
Bordeaux --&gt; Paris: 0.0
Grenoble --&gt; Paris: 500.0
Epinal --&gt; Lyon: 0.0
Bordeaux --&gt; Lyon: 375.0
Grenoble --&gt; Lyon: 375.0
Epinal --&gt; Nantes: 0.0
Bordeaux --&gt; Nantes: 400.0
Grenoble --&gt; Nantes: 0.0
Epinal --&gt; Tulouse: 0.0
Bordeaux --&gt; Tulouse: 250.0
Grenoble --&gt; Tulouse: 0.0
Epinal --&gt; Lille: 25.0
Bordeaux --&gt; Lille: 300.0
Grenoble --&gt; Lille: 625.0
Epinal --&gt; Marseille: 625.0
Bordeaux --&gt; Marseille: 50.0
Grenoble --&gt; Marseille: 175.0
Epinal --&gt; Strasbourg: 150.0
Bordeaux --&gt; Strasbourg: 225.0
Grenoble --&gt; Strasbourg: 125.0
- Shadow prices of supply:
Epinal = -13.0
Bordeaux = -4.0
Grenoble = 0.0
- Shadow prices of demand:
Paris = 30.0
Lyon = 14.0
Nantes = 16.0
Tulouse = 13.0
Lille = 30.0
Marseille = 99.0
Strasbourg = 21.0

* Pannels:
Epinal --&gt; Paris: 0.0
Bordeaux --&gt; Paris: 50.0
Grenoble --&gt; Paris: 50.0
Epinal --&gt; Lyon: 0.0
Bordeaux --&gt; Lyon: 100.0
Grenoble --&gt; Lyon: 0.0
Epinal --&gt; Nantes: 0.0
Bordeaux --&gt; Nantes: 0.0
Grenoble --&gt; Nantes: 0.0
Epinal --&gt; Tulouse: 0.0
Bordeaux --&gt; Tulouse: 50.0
Grenoble --&gt; Tulouse: 0.0
Epinal --&gt; Lille: 200.0
Bordeaux --&gt; Lille: 0.0
Grenoble --&gt; Lille: 0.0
Epinal --&gt; Marseille: 0.0
Bordeaux --&gt; Marseille: 100.0
Grenoble --&gt; Marseille: 0.0
Epinal --&gt; Strasbourg: 0.0
Bordeaux --&gt; Strasbourg: 0.0
Grenoble --&gt; Strasbourg: 250.0
- Shadow prices of supply:
Epinal = -13.0
Bordeaux = -3.0
Grenoble = 0.0
- Shadow prices of demand:
Paris = 32.0
Lyon = 13.0
Nantes = 0.0
Tulouse = 12.0
Lille = 31.0
Marseille = 102.0
Strasbourg = 21.0</code></pre><h3 id="A-nonlinear-example:-portfolio-optimisation"><a class="docs-heading-anchor" href="#A-nonlinear-example:-portfolio-optimisation">A nonlinear example: portfolio optimisation</a><a id="A-nonlinear-example:-portfolio-optimisation-1"></a><a class="docs-heading-anchor-permalink" href="#A-nonlinear-example:-portfolio-optimisation" title="Permalink"></a></h3><p>The problem objective is to choose the shares of different assets in the portfolio (here forest species, but the example is exactly the same considering other assets, for example financial investments) that maximise the portfolio expected returns while minimising its expected variance under the portfolio owner risk aversion risk. Here the &quot;returns&quot; are based on the timber production and the covariance between individual species of the portfolio is based on the observed volume growth covariances. The idea is that within the infinite possible allocations, the locus of those allocations for which is not possible to increase the portfolio profitability without increasing also its variance and the converse whose variance can not be lowered without at the same time lower its expected profitability are efficient in the Pareto meaning and form an &quot;efficient frontier&quot;. Within this frontier the problem is to find the unique point that maximise the utility of the portfolio&#39;s owner given its risk aversion characteristic. Graphically the problem is depicted i nthe following picture:</p><p><img src="https://raw.githubusercontent.com/sylvaticus/IntroSPMLJuliaCourse/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/graph_eff_frontier_v2.png" alt="The efficient frontier and the owner utility curves"/></p><p>Data originally from the Institut national de l&#39;information géographique et forestière (IGN) of France. See the paper <a href="http://dx.doi.org/10.1016/j.forpol.2015.12.010">A. Dragicevic, A. Lobianco, A. Leblois (2016), ”Forest planning and productivity-risk trade-off through the Markowitz mean-variance model“, Forest Policy and Economics, Volume 64</a> for a thorough discussion of this model.</p><p>Declare the packages we are going to use:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using JuMP, Ipopt, StatsPlots</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Forest species names</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; species   = [&quot;Chêne pédonculé&quot;, &quot;Chêne sessile&quot;, &quot;Hêtre&quot;, &quot;Pin sylvestre&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{String}:
 &quot;Chêne pédonculé&quot;
 &quot;Chêne sessile&quot;
 &quot;Hêtre&quot;
 &quot;Pin sylvestre&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nSpecies  = length(species)</code><code class="nohighlight hljs ansi" style="display:block;">4</code></pre><p>Average productiities by specie This is implemented in a dictionary: key-&gt;value</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; y   = Dict( &quot;Chêne pédonculé&quot; =&gt; 1.83933333333333,
                   &quot;Chêne sessile&quot;   =&gt; 2.198,
                   &quot;Hêtre&quot;           =&gt; 3.286,
                   &quot;Pin sylvestre&quot;   =&gt; 3.3695)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, Float64} with 4 entries:
  &quot;Hêtre&quot;           =&gt; 3.286
  &quot;Chêne pédonculé&quot; =&gt; 1.83933
  &quot;Chêne sessile&quot;   =&gt; 2.198
  &quot;Pin sylvestre&quot;   =&gt; 3.3695</code></pre><p>Covariance matrix between species</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; σtable = [[0.037502535947712	0.016082745098039	0.027797176470588	-0.025589882352942]
                 [0.016082745098039	0.015177019607843	0.018791960784314	-0.102880470588234]
                 [0.027797176470588	0.018791960784314	0.031732078431373	-0.166391058823529]
                 [-0.025589882352942	-0.102880470588234	-0.166391058823529	2.02950454411765]]</code><code class="nohighlight hljs ansi" style="display:block;">4×4 Matrix{Float64}:
  0.0375025   0.0160827   0.0277972  -0.0255899
  0.0160827   0.015177    0.018792   -0.10288
  0.0277972   0.018792    0.0317321  -0.166391
 -0.0255899  -0.10288    -0.166391    2.0295</code></pre><p>We reshape the covariance matrix in a dictionary (sp1,sp2) -&gt; value The function (ix,x) = enumerate(X) returns a tuple of index position and element for each element of an array</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; σ = Dict((i,j) =&gt; σtable[i_ix,j_ix] for (i_ix,i) in enumerate(species), (j_ix,j) in enumerate(species))</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Tuple{String, String}, Float64} with 16 entries:
  (&quot;Pin sylvestre&quot;, &quot;Chêne pédonculé&quot;)   =&gt; -0.0255899
  (&quot;Hêtre&quot;, &quot;Chêne pédonculé&quot;)           =&gt; 0.0277972
  (&quot;Chêne pédonculé&quot;, &quot;Chêne sessile&quot;)   =&gt; 0.0160827
  (&quot;Chêne pédonculé&quot;, &quot;Pin sylvestre&quot;)   =&gt; -0.0255899
  (&quot;Chêne pédonculé&quot;, &quot;Hêtre&quot;)           =&gt; 0.0277972
  (&quot;Hêtre&quot;, &quot;Pin sylvestre&quot;)             =&gt; -0.166391
  (&quot;Pin sylvestre&quot;, &quot;Chêne sessile&quot;)     =&gt; -0.10288
  (&quot;Chêne pédonculé&quot;, &quot;Chêne pédonculé&quot;) =&gt; 0.0375025
  (&quot;Hêtre&quot;, &quot;Chêne sessile&quot;)             =&gt; 0.018792
  (&quot;Chêne sessile&quot;, &quot;Hêtre&quot;)             =&gt; 0.018792
  (&quot;Hêtre&quot;, &quot;Hêtre&quot;)                     =&gt; 0.0317321
  (&quot;Chêne sessile&quot;, &quot;Pin sylvestre&quot;)     =&gt; -0.10288
  (&quot;Pin sylvestre&quot;, &quot;Hêtre&quot;)             =&gt; -0.166391
  (&quot;Pin sylvestre&quot;, &quot;Pin sylvestre&quot;)     =&gt; 2.0295
  (&quot;Chêne sessile&quot;, &quot;Chêne sessile&quot;)     =&gt; 0.015177
  (&quot;Chêne sessile&quot;, &quot;Chêne pédonculé&quot;)   =&gt; 0.0160827</code></pre><h4 id="Showing-the-possible-mean/variance-of-the-portfolio-by-simulation"><a class="docs-heading-anchor" href="#Showing-the-possible-mean/variance-of-the-portfolio-by-simulation">Showing the possible mean/variance of the portfolio by simulation</a><a id="Showing-the-possible-mean/variance-of-the-portfolio-by-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Showing-the-possible-mean/variance-of-the-portfolio-by-simulation" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; nSamples = 1000</code><code class="nohighlight hljs ansi" style="display:block;">1000</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; shares   = rand(nSamples,nSpecies);</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Converting to probabilities:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; import BetaML.Utils:softmax</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; [shares[i,:]  = softmax(shares[i,:], β=one.(shares[i,:]) .* 5) for i in 1:nSamples]</code><code class="nohighlight hljs ansi" style="display:block;">1000-element Vector{Vector{Float64}}:
 [0.17335153349707058, 0.2028544675507532, 0.434853465506999, 0.1889405334451771]
 [0.4601396033380132, 0.0849324404589254, 0.23537950092368787, 0.21954845527937344]
 [0.09480772949506396, 0.06159560973824434, 0.7648357423116481, 0.07876091845504399]
 [0.5116176113263505, 0.19309546678940034, 0.2867535849204673, 0.008533336963781557]
 [0.6122479431894607, 0.2282432421083637, 0.06260752379342235, 0.09690129090875335]
 [0.05008657146368862, 0.7627679337377523, 0.17240550372262198, 0.014739991075937339]
 [0.2105918684267626, 0.08388276278270886, 0.37234222690347585, 0.3331831418870528]
 [0.07693605488874525, 0.1814900231552367, 0.5208361577817977, 0.2207377641742205]
 [0.5727338753842612, 0.03746180673429663, 0.36669006219356803, 0.023114255687873984]
 [0.0523981660364178, 0.6385708675052919, 0.2737816178191614, 0.035249348639129145]
 ⋮
 [0.06005044033498477, 0.21850759989252627, 0.2760058373164056, 0.4454361224560831]
 [0.05035647283628192, 0.03252865752680968, 0.466383545659842, 0.4507313239770662]
 [0.07918853957579651, 0.5757973750624649, 0.069428478913596, 0.27558560644814223]
 [0.08592761925553993, 0.8126387424868359, 0.060322985713022845, 0.041110652544601584]
 [0.09034681948863363, 0.3822532149770719, 0.029919722104154608, 0.4974802434301397]
 [0.20398814807426108, 0.01633929820820466, 0.12360307172602164, 0.6560694819915123]
 [0.15978026887646096, 0.28198295206216994, 0.04665986505228694, 0.5115769140090825]
 [0.5466085579201683, 0.1153800798635625, 0.29973186045636135, 0.03827950175990808]
 [0.0148204712124551, 0.020651551458972635, 0.3938682934030551, 0.5706596839255174]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pScores = Array{Float64,2}(undef,0,2)</code><code class="nohighlight hljs ansi" style="display:block;">0×2 Matrix{Float64}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for i in 1:nSamples
           global pScores
           pVar    = sum(shares[i,j1] * shares[i,j2] * σ[species[j1],species[j2]] for j1 in 1:nSpecies, j2 in 1:nSpecies)
           pY      = sum(shares[i,j]*y[species[j]] for j in 1:nSpecies)
           pScores = vcat(pScores,[pVar pY])
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; scatter(pScores[:,1],pScores[:,2],colour=:blue)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code></pre><p><img src="currentPlot13.svg" alt/></p><h4 id="Finding-(one)-optimal-portfolio"><a class="docs-heading-anchor" href="#Finding-(one)-optimal-portfolio">Finding (one) optimal portfolio</a><a id="Finding-(one)-optimal-portfolio-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-(one)-optimal-portfolio" title="Permalink"></a></h4><p>Risk aversion coefficient</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; α = 0.1</code><code class="nohighlight hljs ansi" style="display:block;">0.1</code></pre><p>We declare an optimisation problem, we name it &quot;m&quot; and we let JuMP associate it with the most suitable solver within the one installed:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; port = Model(Ipopt.Optimizer)</code><code class="nohighlight hljs ansi" style="display:block;">A JuMP Model
Feasibility problem with:
Variables: 0
Model mode: AUTOMATIC
CachingOptimizer state: EMPTY_OPTIMIZER
Solver name: Ipopt</code></pre><p>We declare a set of variables, indicized by the species name:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @variables port begin
           x[i in species] &gt;= 0
       end</code><code class="nohighlight hljs ansi" style="display:block;">(1-dimensional DenseAxisArray{JuMP.VariableRef,1,...} with index sets:
    Dimension 1, [&quot;Chêne pédonculé&quot;, &quot;Chêne sessile&quot;, &quot;Hêtre&quot;, &quot;Pin sylvestre&quot;]
And data, a 4-element Vector{JuMP.VariableRef}:
 x[Chêne pédonculé]
 x[Chêne sessile]
 x[Hêtre]
 x[Pin sylvestre],)</code></pre><p>We declare the constraint shat the sum of shares must be equal to 1</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @constraint(port, c_share, sum(x[i] for i in species) == 1)</code><code class="nohighlight hljs ansi" style="display:block;">c_share : x[Chêne pédonculé] + x[Chêne sessile] + x[Hêtre] + x[Pin sylvestre] = 1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @NLobjective port Min α *  sum(x[i] * x[j] * σ[i,j] for i in species for j in species) - sum(x[i] * y[i] for i in species)</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>Print the optimisation model in nice human-readable format:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; print(port)</code><code class="nohighlight hljs ansi" style="display:block;">Min 0.1 * (x[Chêne pédonculé] * x[Chêne pédonculé] * 0.037502535947712 + x[Chêne pédonculé] * x[Chêne sessile] * 0.016082745098039 + x[Chêne pédonculé] * x[Hêtre] * 0.027797176470588 + x[Chêne pédonculé] * x[Pin sylvestre] * -0.025589882352942 + x[Chêne sessile] * x[Chêne pédonculé] * 0.016082745098039 + x[Chêne sessile] * x[Chêne sessile] * 0.015177019607843 + x[Chêne sessile] * x[Hêtre] * 0.018791960784314 + x[Chêne sessile] * x[Pin sylvestre] * -0.102880470588234 + x[Hêtre] * x[Chêne pédonculé] * 0.027797176470588 + x[Hêtre] * x[Chêne sessile] * 0.018791960784314 + x[Hêtre] * x[Hêtre] * 0.031732078431373 + x[Hêtre] * x[Pin sylvestre] * -0.166391058823529 + x[Pin sylvestre] * x[Chêne pédonculé] * -0.025589882352942 + x[Pin sylvestre] * x[Chêne sessile] * -0.102880470588234 + x[Pin sylvestre] * x[Hêtre] * -0.166391058823529 + x[Pin sylvestre] * x[Pin sylvestre] * 2.02950454411765) - (x[Chêne pédonculé] * 1.83933333333333 + x[Chêne sessile] * 2.198 + x[Hêtre] * 3.286 + x[Pin sylvestre] * 3.3695)
Subject to
 c_share : x[Chêne pédonculé] + x[Chêne sessile] + x[Hêtre] + x[Pin sylvestre] = 1
 x[Chêne pédonculé] ≥ 0
 x[Chêne sessile] ≥ 0
 x[Hêtre] ≥ 0
 x[Pin sylvestre] ≥ 0</code></pre><p>Solve the model and return the solving status:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; optimize!(port)</code><code class="nohighlight hljs ansi" style="display:block;">This is Ipopt version 3.14.14, running with linear solver MUMPS 5.6.2.

Number of nonzeros in equality constraint Jacobian...:        4
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:       10

Total number of variables............................:        4
                     variables with only lower bounds:        4
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:        1
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.0691173e-01 9.60e-01 8.33e-01  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -2.6796169e+00 0.00e+00 2.26e+01  -1.7 2.46e-01    -  4.19e-02 1.00e+00f  1
   2 -3.2598524e+00 0.00e+00 2.13e+01  -1.7 6.87e+00    -  4.95e-02 5.88e-02f  1
   3 -3.2590630e+00 1.11e-16 1.93e+01  -1.7 1.61e-01    -  1.00e+00 9.81e-02f  2
   4 -3.2586433e+00 0.00e+00 2.00e-07  -1.7 1.45e-02    -  1.00e+00 1.00e+00f  1
   5 -3.2971652e+00 0.00e+00 4.96e-03  -3.8 7.04e-02    -  9.08e-01 1.00e+00f  1
   6 -3.2983547e+00 0.00e+00 1.50e-09  -3.8 2.19e-02    -  1.00e+00 1.00e+00f  1
   7 -3.2986538e+00 0.00e+00 1.84e-11  -5.7 2.93e-03    -  1.00e+00 1.00e+00f  1
   8 -3.2986576e+00 0.00e+00 2.55e-14  -8.6 4.72e-05    -  1.00e+00 1.00e+00f  1

Number of Iterations....: 8

                                   (scaled)                 (unscaled)
Objective...............:  -3.2986575928648394e+00   -3.2986575928648394e+00
Dual infeasibility......:   2.5521078983849546e-14    2.5521078983849546e-14
Constraint violation....:   0.0000000000000000e+00    0.0000000000000000e+00
Variable bound violation:   8.2731345336654260e-09    8.2731345336654260e-09
Complementarity.........:   3.5155177510884357e-09    3.5155177510884357e-09
Overall NLP error.......:   3.5155177510884357e-09    3.5155177510884357e-09


Number of objective function evaluations             = 11
Number of objective gradient evaluations             = 9
Number of equality constraint evaluations            = 11
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 1
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 8
Total seconds in IPOPT                               = 1.470

EXIT: Optimal Solution Found.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; status = termination_status(port)</code><code class="nohighlight hljs ansi" style="display:block;">LOCALLY_SOLVED::TerminationStatusCode = 4</code></pre><p>Return the objective:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; println(&quot;Objective value: &quot;, objective_value(port))</code><code class="nohighlight hljs ansi" style="display:block;">Objective value: -3.2986575928648394</code></pre><p>Return the value of the decision variable:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; optShares = value.(x)</code><code class="nohighlight hljs ansi" style="display:block;">1-dimensional DenseAxisArray{Float64,1,...} with index sets:
    Dimension 1, [&quot;Chêne pédonculé&quot;, &quot;Chêne sessile&quot;, &quot;Hêtre&quot;, &quot;Pin sylvestre&quot;]
And data, a 4-element Vector{Float64}:
 -8.273134533665426e-9
 -7.695921190269722e-9
  0.7428494846386048
  0.25715053133045096</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; [println(&quot;$sp = $(optShares[sp])&quot;) for sp in species];</code><code class="nohighlight hljs ansi" style="display:block;">Chêne pédonculé = -8.273134533665426e-9
Chêne sessile = -7.695921190269722e-9
Hêtre = 0.7428494846386048
Pin sylvestre = 0.25715053133045096</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pOptVar = sum(optShares[species[j1]] * optShares[species[j2]] * σ[species[j1],species[j2]] for j1 in 1:nSpecies, j2 in 1:nSpecies)</code><code class="nohighlight hljs ansi" style="display:block;">0.0881449684288383</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pOptY   = sum(optShares[species[j]]*y[species[j]] for j in 1:nSpecies)</code><code class="nohighlight hljs ansi" style="display:block;">3.307472089707723</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; function computeOptimalPortfolio(species,y,σ,α)
           port = Model(Ipopt.Optimizer)
           set_optimizer_attribute(port, &quot;print_level&quot;, 0)
           @variables port begin
               x[i in species] &gt;= 0
           end
           @constraint(port, c_share, sum(x[i] for i in species) == 1)
           @NLobjective port Min α *  sum(x[i] * x[j] * σ[i,j] for i in species for j in species) - sum(x[i] * y[i] for i in species)
           optimize!(port)
           status = termination_status(port)
           optShares = value.(x)
           pOptVar = sum(optShares[species[j1]] * optShares[species[j2]] * σ[species[j1],species[j2]] for j1 in 1:nSpecies, j2 in 1:nSpecies)
           pOptY   = sum(optShares[species[j]]*y[species[j]] for j in 1:nSpecies)
           return (pOptVar,pOptY)
       end</code><code class="nohighlight hljs ansi" style="display:block;">computeOptimalPortfolio (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; αs = [1000,100,10,1,0.1,0.05,0.02,0.01]</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Float64}:
 1000.0
  100.0
   10.0
    1.0
    0.1
    0.05
    0.02
    0.01</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pOptScores = Array{Float64,2}(undef,0,2)</code><code class="nohighlight hljs ansi" style="display:block;">0×2 Matrix{Float64}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for α in αs
           global pOptScores
           pVar,pY =computeOptimalPortfolio(species,y,σ,α)
           pOptScores = vcat(pOptScores,[pVar pY])
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; scatter!(pOptScores[:,1],pOptScores[:,2],colour=:red)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=2}</code></pre><p><img src="currentPlot14.svg" alt/></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; αs = [82.45,50,30,20,15,12,10,9,8,7,6,5]</code><code class="nohighlight hljs ansi" style="display:block;">12-element Vector{Float64}:
 82.45
 50.0
 30.0
 20.0
 15.0
 12.0
 10.0
  9.0
  8.0
  7.0
  6.0
  5.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; pOptScores = Array{Float64,2}(undef,0,2)</code><code class="nohighlight hljs ansi" style="display:block;">0×2 Matrix{Float64}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for α in αs
           global pOptScores
           pVar,pY =computeOptimalPortfolio(species,y,σ,α)
           pOptScores = vcat(pOptScores,[pVar pY])
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; scatter(pOptScores[:,1],pOptScores[:,2],colour=:red)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code></pre><p><img src="currentPlot15.svg" alt/></p><p><a href="0202_-_Miscellaneous_topics.jl">View this file on Github</a>.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/runner/work/SPMLJ/SPMLJ/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/0202_-_Miscellaneous_topics.md",
"title" : "0202_-_Miscellaneous_topics.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="0201_-_Wranging_data.html">« 0201 - Wranging data</a><a class="docs-footer-nextpage" href="0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 7 May 2024 14:46">Tuesday 7 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
