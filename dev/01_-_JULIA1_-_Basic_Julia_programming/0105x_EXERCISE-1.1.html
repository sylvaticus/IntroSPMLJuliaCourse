<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>0105x EXERCISE-1.1 · SPMLJ</title><meta name="title" content="0105x EXERCISE-1.1 · SPMLJ"/><meta property="og:title" content="0105x EXERCISE-1.1 · SPMLJ"/><meta property="twitter:title" content="0105x EXERCISE-1.1 · SPMLJ"/><meta name="description" content="Documentation for SPMLJ."/><meta property="og:description" content="Documentation for SPMLJ."/><meta property="twitter:description" content="Documentation for SPMLJ."/><script async src="https://www.googletagmanager.com/gtag/js?id=G-Q39LHCRBB6"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Q39LHCRBB6', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">SPMLJ</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Index</a></li><li><span class="tocitem">Lessons</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">INTRO - Introduction to the course, Julia and ML</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0001_-_Course_presentation.html">0001 - Course presentation</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0002_-_Program.html">0002 - Program</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0003_-_Introduction_to_Julia.html">0003 - Introduction to Julia</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0003q_-_QUIZ_0.1.html">0003q - QUIZ 0.1</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004_-_Introduction_to_ML.html">0004 - Introduction to ML</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004q_-_QUIZ_0.2.html">0004q - QUIZ 0.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">JULIA1 - Basic Julia programming</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="0101_-_Basic_syntax.html">0101 - Basic syntax</a></li><li><a class="tocitem" href="0101q_-_QUIZ_1.1.html">0101q - QUIZ 1.1</a></li><li><a class="tocitem" href="0101q_-_QUIZ_1.2.html">0101q - QUIZ 1.2</a></li><li><a class="tocitem" href="0102_-_Types_and_objects.html">0102 - Types and objects</a></li><li><a class="tocitem" href="0102q_-_QUIZ_1.3.html">0102q - QUIZ 1.3</a></li><li><a class="tocitem" href="0103_-_Predefined_types.html">0103 - Predefined types</a></li><li><a class="tocitem" href="0103q_-_QUIZ_1.4.html">0103q - QUIZ 1.4</a></li><li><a class="tocitem" href="0103q_-_QUIZ_1.5.html">0103q - QUIZ 1.5</a></li><li><a class="tocitem" href="0103q_-_QUIZ_1.6.html">0103q - QUIZ 1.6</a></li><li><a class="tocitem" href="0104_-_Control_flow_and_functions.html">0104 - Control flow and functions</a></li><li><a class="tocitem" href="0104q_-_QUIZ_1.7.html">0104q - QUIZ 1.7</a></li><li><a class="tocitem" href="0104q_-_QUIZ_1.8.html">0104q - QUIZ 1.8</a></li><li><a class="tocitem" href="0105_-_Custom_types.html">0105 - Custom types</a></li><li><a class="tocitem" href="0105q_-_QUIZ_1.10.html">0105q - QUIZ 1.10</a></li><li><a class="tocitem" href="0105q_-_QUIZ_1.9.html">0105q - QUIZ 1.9</a></li><li class="is-active"><a class="tocitem" href="0105x_EXERCISE-1.1.html">0105x EXERCISE-1.1</a><ul class="internal"><li><a class="tocitem" href="#Instructions"><span>Instructions</span></a></li><li><a class="tocitem" href="#Resolution"><span>Resolution</span></a></li></ul></li><li><a class="tocitem" href="0106_-_Further_topics.html">0106 - Further topics</a></li><li><a class="tocitem" href="0106q_-_QUIZ_1.11.html">0106q - QUIZ 1.11</a></li><li><a class="tocitem" href="0106q_-_QUIZ_1.12.html">0106q - QUIZ 1.12</a></li><li><a class="tocitem" href="0106q_-_QUIZ_1.13.html">0106q - QUIZ 1.13</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">JULIA2 - Scientific programming with Julia</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../02_-_JULIA2_-_Scientific_programming_with_Julia/0201_-_Wranging_data.html">0201 - Wranging data</a></li><li><a class="tocitem" href="../02_-_JULIA2_-_Scientific_programming_with_Julia/0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics</a></li><li><a class="tocitem" href="../02_-_JULIA2_-_Scientific_programming_with_Julia/0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1</a></li><li><a class="tocitem" href="../02_-_JULIA2_-_Scientific_programming_with_Julia/0202x_EXERCISE-2.2.html">0202x EXERCISE-2.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">ML1 - Introduction to Machine Learning</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0301_-_Machine_learning_main_concepts.html">0301 - Machine learning main concepts</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302_-_The_Perceptron_classifier.html">0302 - The Perceptron classifier</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302x_EXERCISE-3.1.html">0302x EXERCISE-3.1</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">NN - Neural Networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0401_-_Neural_network_architectures.html">0401 - Neural network architectures</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402_-_Implementation_of_neural_networks_workflows.html">0402 - Implementation of neural networks workflows</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.1.html">0402x EXERCISE-4.1</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.2.html">0402x EXERCISE-4.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">DT - Decision trees based algorithms [DRAFT]</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0501_-_Decision_trees_based_algorithms.html">0501 - Decision trees based algorithms</a></li><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0502x_EXERCISE-5.1.html">0502x EXERCISE-5.1</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lessons</a></li><li><a class="is-disabled">JULIA1 - Basic Julia programming</a></li><li class="is-active"><a href="0105x_EXERCISE-1.1.html">0105x EXERCISE-1.1</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="0105x_EXERCISE-1.1.html">0105x EXERCISE-1.1</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sylvaticus/SPMLJ" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sylvaticus/SPMLJ/blob/main/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="EXERCISE-1.1:-The-Schelling-Segregation-Model"><a class="docs-heading-anchor" href="#EXERCISE-1.1:-The-Schelling-Segregation-Model">EXERCISE 1.1: The Schelling Segregation Model</a><a id="EXERCISE-1.1:-The-Schelling-Segregation-Model-1"></a><a class="docs-heading-anchor-permalink" href="#EXERCISE-1.1:-The-Schelling-Segregation-Model" title="Permalink"></a></h1><p>&nbsp;</p>
<img src="imgs/shelling1.png" alt="Shelling model output" style="height:150px;"> 
<img src="imgs/shelling2.png" alt="Shelling model output" style="height:150px;"> 
<img src="imgs/shelling3.png" alt="Shelling model output" style="height:150px;">  
<img src="imgs/shelling4.png" alt="Shelling model output" style="height:150px;">
<p>&nbsp;</p><p>In this exercise you will implement the <a href="https://en.wikipedia.org/wiki/Schelling%27s_model_of_segregation">Shelling Segregation Model</a>, a classical agent-based model in the social sciences, introducing the concepts of emerging macro behaviours and tipping points, leading to its author (Thomas Schelling) receiving the Nobel prize in Economics in 2005.</p><p>It has been one of the very first results obtained from running simulations, especially in the social sciences. The World is modelled as a gridded space inhabited by two groups (in that period racial and segregation questions concerning the cohabitation of &quot;blacks&quot; and &quot;whites&quot; were topical). Each group has a preference to live in a neighbourhood inhabited by agents of their own type, with a certain &quot;tolerance&quot;. When the share of agents of its own type in the neighbourhood falls below this &quot;tolerance&quot; level, the agent tries to relocate somewhere with a higher share of its own type of agents. The main result of the paper was that even a relatively mild preference for the presence of similar agents would have led to a segregated world and that there was a specific threshold level (between 30% and 40%) that was driving these two completely different outputs, i.e. a &quot;tipping point&quot;.</p><p>The simulation algorithm then goes in this way: For each step, look at each agent, check if it is &quot;happy&quot; with its current location (looking at the share of own types in the neighbourhood), and, if not, relocate the agent to a position where it would be (setting its past location as empty).</p><p>There are various ways of &quot;generality&quot; vs &quot;specificity&quot; to code the algorithm above. On one end you could hard-code the two agent types, e.g. as <code>1</code> and <code>2</code>, on the other you could be very generic and create an abstract type <code>Agent</code> and a concrete class for each agent type.</p><p>The skeleton below proposes an intermediate approach with only one <code>Agent</code> class and the kind of agent encoded as an integer, with 0 representing an empty cell. Fill free to use it or to develop your own algorithm from scratch!</p><p>Source: Thomas C. Schelling (1971) Dynamic models of segregation, The Journal of Mathematical Sociology, 1:2, 143-186, DOI: <a href="https://doi.org/10.1080/0022250X.1971.9989794">10.1080/0022250X.1971.9989794</a> </p><p><strong>Skills employed:</strong></p><ul><li>design custom types</li><li>defining and calling functions</li><li>manipulating arrays</li><li>use conditional statements and for loops</li><li>plotting</li></ul><h2 id="Instructions"><a class="docs-heading-anchor" href="#Instructions">Instructions</a><a id="Instructions-1"></a><a class="docs-heading-anchor-permalink" href="#Instructions" title="Permalink"></a></h2><p>If you have already cloned or downloaded the whole <a href="https://github.com/sylvaticus/SPMLJ/">course repository</a> the folder with the exercise is on <code>[REPOSITORY_ROOT]/lessonsMaterial/01_JULIA1/shellingSegregationModel</code>. Otherwise download a zip of just that folder <a href="https://downgit.github.io/#/home?url=https://github.com/sylvaticus/SPMLJ/tree/main/lessonsMaterial/01_JULIA1/shellingSegregationModel">here</a>.</p><p>In the folder you will find the file <code>shellingSegreGationModel.jl</code> containing the julia file that <strong>you will have to complete to implement and run the model</strong> (follow the instructions on that file).  In that folder you will also find the <code>Manifest.toml</code> file. The proposal of resolution below has been tested with the environment defined by that file.   If you are stuck and you don&#39;t want to lookup to the resolution above you can also ask for help in the forum at the bottom of this page. Good luck! </p><h2 id="Resolution"><a class="docs-heading-anchor" href="#Resolution">Resolution</a><a id="Resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Resolution" title="Permalink"></a></h2><p>Click &quot;ONE POSSIBLE SOLUTION&quot; to get access to (one possible) solution for each part of the code that you are asked to implement.</p><hr/><h3 id="1)-Setting-the-environment..."><a class="docs-heading-anchor" href="#1)-Setting-the-environment...">1) Setting the environment...</a><a id="1)-Setting-the-environment...-1"></a><a class="docs-heading-anchor-permalink" href="#1)-Setting-the-environment..." title="Permalink"></a></h3><pre><code class="language-julia hljs">cd(@__DIR__)         
using Pkg             
Pkg.activate(&quot;.&quot;)   
# If using a Julia version different than 1.7 please uncomment and run the following line (reproductibility guarantee will hower be lost)
# Pkg.resolve()   
Pkg.instantiate()
using Random
Random.seed!(123)
using Plots</code></pre><hr/><h3 id="2)-Defining-the-Agent-and-Env-classes..."><a class="docs-heading-anchor" href="#2)-Defining-the-Agent-and-Env-classes...">2) Defining the <code>Agent</code> and <code>Env</code> classes...</a><a id="2)-Defining-the-Agent-and-Env-classes...-1"></a><a class="docs-heading-anchor-permalink" href="#2)-Defining-the-Agent-and-Env-classes..." title="Permalink"></a></h3><pre><code class="language-julia hljs">mutable struct Agent
    gid::Int64
end
mutable struct Env
    nR::Int64                       # number of rows
    nC::Int64                       # number of columns
    similarityThreeshold::Float64   # threeshold for agents to be &quot;happy&quot; with their location
    neighborhood::Int64             # how far looking for &quot;similar&quot; agents
    nSteps::Int64                   # number of iteractive steps to employ
    cells::Vector{Agent}            # total cells in the environment
    gids::Vector{Int64}             # ids of the agents types (or &quot;groups&quot;)
    grsizes::Vector{Int64}          # number of agents per group
end</code></pre><hr/><h3 id="3)-Defining-some-utility-functions..."><a class="docs-heading-anchor" href="#3)-Defining-some-utility-functions...">3) Defining some utility functions...</a><a id="3)-Defining-some-utility-functions...-1"></a><a class="docs-heading-anchor-permalink" href="#3)-Defining-some-utility-functions..." title="Permalink"></a></h3><pre><code class="language-julia hljs">xyToId(x,y,nR,nC) =  nR*(x-1)+y
iDToXY(id,nR,nC)  =  Int(floor((id-1)/nR)+1), (id-1)%(nR)+1
printableGrid(env) = reshape([a.gid for a in env.cells],env.nR,env.nC)</code></pre><hr/><h3 id="4)-Defining-the-main-functions-of-the-algorithm..."><a class="docs-heading-anchor" href="#4)-Defining-the-main-functions-of-the-algorithm...">4) Defining the main functions of the algorithm...</a><a id="4)-Defining-the-main-functions-of-the-algorithm...-1"></a><a class="docs-heading-anchor-permalink" href="#4)-Defining-the-main-functions-of-the-algorithm..." title="Permalink"></a></h3><pre><code class="language-julia hljs">&quot;&quot;&quot;
   getNeighbours(x,y,env,gid=nothing)

Return the number of total neighbours if `gid` is `nothing` (skipping the empty cells) or of a specific `gid` if this one is provided.

&quot;&quot;&quot;
function getNeighbours(x,y,env,gid=nothing)
    board  = reshape(env.cells,env.nR,env.nC)
    region = board[max(1,y-env.neighborhood):min(nR,y+env.neighborhood),max(1,x-env.neighborhood):min(nC,x+env.neighborhood)]
    ## [...] Write your code here </code></pre><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">    if gid == nothing
        return sum(getproperty.(region, :gid) .!= 0) # return all agents that are not zero
    else
        return sum(getproperty.(region, :gid).== gid)
    end</code></pre></details><pre><code class="language-julia hljs">end</code></pre><pre><code class="language-julia hljs">&quot;&quot;&quot;
   isHappy(x,y,a,env)

Return whether the specific agent `a` is happy at his current location
&quot;&quot;&quot;
function isHappy(x,y,a,env)
   ## [...] Write your code here</code></pre><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">    totalNeighbours  = getNeighbours(x,y,env)
    myTypeNeighbours = getNeighbours(x,y,env,a.gid)
    return myTypeNeighbours/totalNeighbours &gt; env.similarityThreeshold</code></pre></details><pre><code class="language-julia hljs">end

&quot;&quot;&quot;
   reallocatePoints!(env)

Loop over all the cells and if an agent on that location is unhappy, it moves it to a location where it is happy and set the departing cell as empty (i.e. occupied by an agent whose gid is zero).
It returns the share of agents that were happy before the move.
&quot;&quot;&quot;
function reallocatePoints!(env)
    happyCount = 0
    for (i,a) in enumerate(env.cells)
       ## [...] Write your code here</code></pre><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">        gid = a.gid
        if gid == 0 continue; end
        (x,y) = iDToXY(i,env.nR,env.nC)
        if isHappy(x,y,a,env)
            happyCount += 1
        else
            candIds = shuffle(1:env.nR*env.nC)
            for cId in candIds
                if env.cells[cId].gid != 0 continue; end
                (xc,yc) = iDToXY(cId,env.nR,env.nC)
                if isHappy(xc,yc,a,env)
                    env.cells[cId] = Agent(gid)
                    env.cells[i]   = Agent(0)
                    break
                end
            end
        end</code></pre></details><pre><code class="language-julia hljs">    end
    return happyCount/sum(env.grsizes)
end

&quot;&quot;&quot;
    run!(env)

Run the reallocation algorithm for the given steps printing a heatmap at each iteration.
Also, print at the end the chart of the happy agents by epoch
&quot;&quot;&quot;
function run!(env)
    outplot = heatmap(printableGrid(env), legend=nothing, title=&quot;START&quot;, color=mypal,aspect_ratio=env.nR/env.nC, size=(600,600*env.nR/env.nC))
    nHappyCount = Float64[]
    display(outplot)
    for i in 1:env.nSteps
        println(&quot;Running iteration $i...&quot;)
        nHappy = reallocatePoints!(env)
        push!(nHappyCount,nHappy)
        outplot = heatmap(printableGrid(env), legend=nothing, title=&quot;Iteration $i&quot;, color=mypal,aspect_ratio=env.nR/env.nC, size=(600,600*env.nR/env.nC))
        display(outplot)
    end
    happyCountPlot = plot(nHappyCount,title=&quot;Share of happy agents by iteration&quot;)
    display(happyCountPlot)
end</code></pre><hr/><h3 id="5)-Setting-the-parameters-of-the-specific-simulation-to-run..."><a class="docs-heading-anchor" href="#5)-Setting-the-parameters-of-the-specific-simulation-to-run...">5) Setting the parameters of the specific simulation to run...</a><a id="5)-Setting-the-parameters-of-the-specific-simulation-to-run...-1"></a><a class="docs-heading-anchor-permalink" href="#5)-Setting-the-parameters-of-the-specific-simulation-to-run..." title="Permalink"></a></h3><pre><code class="language-julia hljs"># Parameters...
nR         = 200
nC         = 200
nSteps     = 20
similarityThreeshold = 0.4         # Agent is happy if at least 40% similar
neighborhood = 5                   # Defining how far looking for similar agents
mypal        = [:white,:red,:blue] # First colour is for the empty cell
gids         = [1,2]               # Gid 0 is reserved for empty cell
grShares     = [0.4,0.4]           # Shares of cells occupied by agents, by type</code></pre><hr/><h3 id="6)-Initialising-the-simulation-with-the-given-parameters..."><a class="docs-heading-anchor" href="#6)-Initialising-the-simulation-with-the-given-parameters...">6) Initialising the simulation with the given parameters...</a><a id="6)-Initialising-the-simulation-with-the-given-parameters...-1"></a><a class="docs-heading-anchor-permalink" href="#6)-Initialising-the-simulation-with-the-given-parameters..." title="Permalink"></a></h3><pre><code class="language-julia hljs">nCells  = nR*nC
nGroups = length(gids)
grsizes = Int.(ceil.(nCells .* grShares))

cells  = fill(Agent(0),nCells)
count = 1
for g in 1:nGroups
    [cells[j] = Agent(gids[g]) for j in count:count+grsizes[g]-1]
    count += grsizes[g]
end 

shuffle!(cells)
env = Env(nR,nC,similarityThreeshold,neighborhood,nSteps,cells,gids,grsizes)
heatmap(printableGrid(env), legend=nothing, title=&quot;Iteration 0&quot;, color=mypal,aspect_ratio=env.nR/env.nC, size=(600,600*env.nR/env.nC))</code></pre><hr/><h3 id="7)-Running-the-model..."><a class="docs-heading-anchor" href="#7)-Running-the-model...">7) Running the model...</a><a id="7)-Running-the-model...-1"></a><a class="docs-heading-anchor-permalink" href="#7)-Running-the-model..." title="Permalink"></a></h3><pre><code class="language-julia hljs">run!(env)</code></pre><hr/><h3 id="8)-Optional-variations..."><a class="docs-heading-anchor" href="#8)-Optional-variations...">8) Optional variations...</a><a id="8)-Optional-variations...-1"></a><a class="docs-heading-anchor-permalink" href="#8)-Optional-variations..." title="Permalink"></a></h3><p>You can try to implement variations of this model. Some ideas:</p><ul><li>implement multiple agent groups;</li><li>run Monte-Carlo simulations with respect to the tolerance threshold, with it being a property of the agent rather than of the group, perhaps with the group having a certain distribution of it and each agent of that group sampling from it;</li><li>implement two thresholds, with one to define happiness and one to define the actual decision to move (to consider costs associated with relocation);</li><li>....</li></ul><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/lobianco/CloudFiles/lef-nancy-sync/Documents/Teaching/2021-2022/Introduction to Scientific Programming and Machine Learning with Julia/SPMLJ/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md",
"title" : "0105x_EXERCISE-1.1.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/lobianco/CloudFiles/lef-nancy-sync/Documents/Teaching/2021-2022/Introduction to Scientific Programming and Machine Learning with Julia/SPMLJ/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md",
"title" : "0105x_EXERCISE-1.1.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/lobianco/CloudFiles/lef-nancy-sync/Documents/Teaching/2021-2022/Introduction to Scientific Programming and Machine Learning with Julia/SPMLJ/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md",
"title" : "0105x_EXERCISE-1.1.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/lobianco/CloudFiles/lef-nancy-sync/Documents/Teaching/2021-2022/Introduction to Scientific Programming and Machine Learning with Julia/SPMLJ/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md",
"title" : "0105x_EXERCISE-1.1.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/lobianco/CloudFiles/lef-nancy-sync/Documents/Teaching/2021-2022/Introduction to Scientific Programming and Machine Learning with Julia/SPMLJ/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md",
"title" : "0105x_EXERCISE-1.1.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
const pageURL = window.location.href;
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/runner/work/SPMLJ/SPMLJ/lessonsSources/01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.md",
"title" : "0105x_EXERCISE-1.1.md",
"permalink" : pageURL
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="💬 website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="0105q_-_QUIZ_1.9.html">« 0105q - QUIZ 1.9</a><a class="docs-footer-nextpage" href="0106_-_Further_topics.html">0106 - Further topics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 7 May 2024 14:46">Tuesday 7 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
